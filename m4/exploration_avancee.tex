\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Analyse des données multi-dimensionnelles},
            pdfauthor={Vivien Roussez \& Pascal Irz},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Analyse des données multi-dimensionnelles}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Vivien Roussez \& Pascal Irz}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{26 September 2019}

\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

\includegraphics{images/crabe.jpg}

\emph{Crédit photographique Pascal Irz}

\hypertarget{le-parcours-de-formation}{%
\section{Le parcours de formation}\label{le-parcours-de-formation}}

Ce dispositif de formation vise à faire monter en compétence les agents du MTES (Ministère de la transition écologique et solidaire) et du MCT (Ministère de la cohésion des territoires) dans le domaine de la science de la donnée avec le logiciel R. Il est conçu pour être déployé à l'échelle nationale par le réseau des CVRH (Centre de Valorisation des Ressources Humaines).

Le parcours proposé est structuré en modules de 2 jours chacun. Les deux premiers (ou un niveau équivalent) sont des pré-requis pour suivre les suivants qui sont proposés ``à la carte'' :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Socle : Premier programme en R
\item
  Socle : Préparation des données
\item
  Statistiques descriptives
\item
  Analyses multivariées
\item
  Datavisualisation : Produire des graphiques, des cartes et des tableaux
\item
  Documents reproductibles avec RMarkdown (2\textsuperscript{ème} semestre 2019)
\end{enumerate}

\ldots{} et en perspective : analyse spatiale, applis interactives avec Shiny, big data, etc.

La mise à disposition des supports de formation se fait désormais par la \href{https://mtes-mct.github.io/parcours-r/}{page d'accueil du parcours de formation}. Ces supports sont en \href{https://www.etalab.gouv.fr/wp-content/uploads/2017/04/ETALAB-Licence-Ouverte-v2.0.pdf}{licence ouverte}.

Si vous souhaitez accéder aux sources, données mobilisées pendant les formations, il faut directement les télécharger depuis le \href{https://github.com/MTES-MCT/parcours-r/tree/master/Supports_formations}{Github du ministère}.

Pour vous tenir au courant de l'offre de formation proposée par le réseau des CVRH, \href{http://oups-cmvrh.e2.rie.gouv.fr/}{consultez la plateforme OUPS}. Vous pouvez vous y abonner pour recevoir les annonces qui vous intéressent.

Il existe une liste pour diffuser de l'information, échanger autour de R ou lever des points de blocage. Pour s'insrire, envoyer un message vide avec le titre ``subscribe labo.communaute-r'' à l'adresse \href{mailto:sympa@developpement-durable.gouv.fr}{\nolinkurl{sympa@developpement-durable.gouv.fr}}.

\hypertarget{objectifs-du-module-4}{%
\section{Objectifs du module 4}\label{objectifs-du-module-4}}

\begin{itemize}
\tightlist
\item
  Connaissance (de certains) des outils R d'analyse des données multivariées.
\item
  Quelques rappels sur l'interprétation des résultats.
\item
  Mise en oeuvre et interprétation des méthodes usuelles.
\end{itemize}

Ce module balaye les techniques statistiques qui permettent d'explorer efficacement un jeu de données contenant un nombre important de variables. Ces méthodes produisent des graphiques et des statistiques qui mettent en évidence les liens et corrélations entre \(p\) variables simultanément, ainsi que les proximités entre les \(n\) observations.

\includegraphics{exploration_avancee_files/figure-latex/unnamed-chunk-1-1.pdf}

Il fait une petite entorse à la philosophie générale du parcours, dans la mesure où le principal \emph{package} mobilisé ne fait pas partie du \emph{tidyverse}, et que les sorties graphiques sont des graphiques R de base. Mais ceux-ci ont une vocation essentiellement exploratoire (on publie rarement les graphiques qui seront vus dans ce module) ; il est naturellement toujours possible de basculer dans le \emph{tidyverse} modulo quelques opérations.

Les méthodes abordées sont les suivantes :

\begin{itemize}
\tightlist
\item
  Analyse en composantes principales (ACP)
\item
  Analyse factorielle des correspondances (AFC)
\item
  Analyse des correspondances multiples (ACM)
\item
  Classification ascendante hiérarchique (CAH)
\item
  K-means
\end{itemize}

Elles permettent d'explorer un jeu de données complexe en l'abordant comme un tout, au lieu d'en étudier les variables une par une, voire en les croisant par paires. Ces méthodes sont utlisées dans de nombreux champs :

\begin{itemize}
\tightlist
\item
  Ecologie
\item
  Sociologie
\item
  Chimie
\item
  Biologie
\item
  Economie
\item
  Géographie
\item
  Psychologie
\item
  etc.
\end{itemize}

La lecture des résultats est facilitée par des représentations graphiques à la lecture relativement intuitive.

\hypertarget{intro}{%
\chapter{Les analyses multivariées}\label{intro}}

\hypertarget{objectifs}{%
\section{Objectifs}\label{objectifs}}

On dispose d'un grand volume de données :

\begin{itemize}
\tightlist
\item
  \(n\) individus
\item
  \(p\) variables, avec \(p>2\), potentiellement de natures différentes (qualitatives, quantitatives, binaires\ldots{})
\end{itemize}

\(\Rightarrow\) On ne peut pas examiner tous les croisements des variables 2 à 2.

L'analyse multidimensionelle permet de croiser toutes les variables simultanément et de synthétiser l'information.

\textbf{Les méthodes présentées ici entrent dans la famille des statistiques exploratoires, très utiles pour défricher certains jeux de données. Par contre, en général elles ne permettent pas directement de tester des hypothèses et encore moins d'inférer des causalités. }

\hypertarget{comment-synthetiser}{%
\section{Comment synthétiser ?}\label{comment-synthetiser}}

\begin{itemize}
\tightlist
\item
  On souhaite passer d'un espace trop grand, non visualisable (\(p\) dimensions) à un espace plus petit (moins de dimension).
\item
  Mais on souhaite conserver l'essentiel de la variabilité entre individus \(\Rightarrow\) Concept \textbf{d'inertie du nuage de points}.
\end{itemize}

\textbf{Solution} : On construit un nouvel espace, dans lequel l'inertie est concentrée sur les premiers axes factoriels. Autrement dit, on construit des nouvelles variables (qui définissent le nouvel espace), combinaisons linéaires des variables initiales, pour lesquelle l'inertie est maximale sur le nombre le plus réduit possible.

\hypertarget{quelles-methodes}{%
\section{Quelles méthodes ?}\label{quelles-methodes}}

Une première partie sera consacrée aux \textbf{analyses factorielles}. Ces dernières permettent de voir rapidement les corrélations ou liens entre variables dans le jeu de données, et de diminuer l'espace d'analyse en construisant des variables synthétiques. Quelques exemples :

\begin{itemize}
\tightlist
\item
  \textbf{ACP} (analyse en composantes principales) : analyse de \(p\) variables \emph{quantitatives}
\item
  \textbf{AFC} (analyse factorielle des correspondances) : analyse de 2 variable \emph{qualitatives}
\item
  \textbf{ACM} (analyse des correspondances multiples) : analyse de \(p\) variable \emph{qualitatives}
\item
  etc\ldots{}
\end{itemize}

Quand on emploie ces méthodes, la procédure à suivre est toujours la même :

\begin{itemize}
\tightlist
\item
  Implémentation de la méthode choisie \(\rightarrow\) création d'un objet R.
\item
  Choix du nombre de variables synthétiques retenues.
\item
  Interprétation des résultats :

  \begin{itemize}
  \tightlist
  \item
    Comment sont corrélées les variables initiales ?
  \item
    Quel sens puis-je donner à mes variables synthétiques ?
  \item
    Est-ce que des groupes d'individus se dégagent ?
  \end{itemize}
\end{itemize}

On verra enfin deux méthodes de classification (attention pour vos recherches en anglais : \emph{clustering} est le terme correspondant ; \emph{classification} fait référence aux algorithmes de discrimination). Ces méthodes visent à regrouper \(n\) individus en \(k\) classes, à partir de \(p\) variables (continues ou qualitatives). Quelques exemples :

\begin{itemize}
\tightlist
\item
  \textbf{CAH} (classification ascendante hiérarchique)
\item
  \textbf{K-moyennes} ou ``nuées dynamiques''
\item
  DBscan
\item
  X-means
\end{itemize}

Une ressource inestimable pour les méthodes de \emph{clustering} (et le machine learning en général) : \href{http://scikit-learn.org/stable/modules/clustering.html\#clustering}{Page de Scikit-lean}.

\hypertarget{lien-entre-ces-methodes}{%
\section{Lien entre ces méthodes}\label{lien-entre-ces-methodes}}

\begin{itemize}
\tightlist
\item
  Toutes visent à diminuer la dimension de l'espace d'analyse et à résumer au mieux l'information.
\item
  Elles se basent toutes sur le critère d'inertie, autrement dit sur l'hétérogénéité des individus.
\item
  Pour toutes, il faut choisir le nombre de variables (ou de classes) à retenir.
\item
  Les analyses factorielles permettent de repérer les variables qui permettent le plus de résumer l'information.
\item
  La classification permet de regrouper les individus aux caractéristiques proches. C'est la méthode la plus synthétique, donc la plus réductrice.
\item
  Il est souvent pertinent d'utiliser une analyse factorielle + une méthode de partitionnement en complément pour bien comprendre l'information contenue dans les données.
\end{itemize}

\hypertarget{notion-de-distance}{%
\section{Notion de distance}\label{notion-de-distance}}

On parle de proximité entre les individus \(\Rightarrow\) comment la mesurer ? Par une distance.

Exemple de la distance euclidienne en 3D : \(D = \sqrt{(x_{b}-x_{a})^2+(y_{b}-y_{a})^2+(z_{b}-z_{a})^2}\)

Il existe de nombreuses autres distances qui répondent à différents usages. En restant dans le domaine des distances géographiques, il existe par exemple la distance orthodromique, utilisée par les marins, qui est la plus courte à la surface du globe terrestre entre deux points (calculable avec les packages \href{https://cran.r-project.org/web/packages/geosphere/geosphere.pdf}{geosphere} ou \href{https://cran.r-project.org/web/packages/fields/fields.pdf}{fields}), ou la distance curviligne le long d'un réseau hydrographique utilisée par les hydrologues (calculable avec le \href{https://cran.r-project.org/web/packages/riverdist/riverdist.pdf}{package riverdist}).

En génétique des populations, on utilise la distance génétique pour mesurer le degré de dissemblance entre deux génomes.

En écologie des communautés, l'indice de Jaccard permet de comparer la composition en espèces de deux communautés A et B. C'est le pourcentage du nombre total d'espèces présentes dans au moins un des échantillons qui est commun aux deux échantillons :

\(J(A,B) = \frac{|A \cap B|}{|A \cup B|}\)

\includegraphics[width=0.5\textwidth,height=\textheight]{images/jaccard.png}

C'est donc un indice de proximité qui varie de 0\% (aucune espèce n'est commune aux deux échantillons) à 100\% (toutes les espèces sont communes à A et à B).

La distance de Jaccard est \(D_j = 1 - J\).

\(\Rightarrow\) Il existe de nombreuses autres distances correspondant à différents usages et métiers.

En statistiques, on est amené à utiliser des distances ``exotiques'' en plus de la distance euclidienne et de la distance de Jaccard : Distance du \({\chi}^2\) (en AFC et ACM), Mahalanobis, Bray-Curtis \ldots{}

\hypertarget{questions-a-se-poser}{%
\section{Questions à se poser}\label{questions-a-se-poser}}

Mon objectif est de :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Déterminer une typologie \(\Rightarrow\) classification / partitionnement.
\item
  Explorer des liens entre variables et entre individus \(\Rightarrow\) analyses factorielles.
\end{enumerate}

Puis, si l'on est dans le cas n°2, \href{https://youtu.be/aiqGyLGrQ48}{cette petite vidéo} (en anglais, mais l'accent de l'auteur aide à la compréhension) donne un rapide aperçu des questions à se poser avant de se lancer dans les analyses. On peut la résumer ainsi :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\item
  Que représente mon tableau de données ?

  \begin{itemize}
  \tightlist
  \item
    Un tableau de contingence \(\Rightarrow\) AFC
  \item
    Un tableau de \(n\) individus x \(p\) variables \(\Rightarrow\) aller au point 4.
  \end{itemize}
\item
  Quels sont les éléments (lignes, colonnes) qui seront ``actifs'', c'est-à-dire qui participeront à la constitution des axes, donc à la détermination des distances entre les individus ? Les autres éléments, dits ``supplémentaires'', pourront être positionnés après coup sur les axes.
\item
  Les variables sont-elles quantitatives ou qualitatives ?

  \begin{itemize}
  \tightlist
  \item
    Quantitatives \(\Rightarrow\) ACP
  \item
    Qualitatives, 2 variables et tableau de contingence \(\Rightarrow\) AFC
  \item
    Qualitatives, autres cas \(\Rightarrow\) ACM
  \end{itemize}
\item
  Si l'on est dans le cas de l'ACP, doit-on standardiser les variables ?
\item
  Y a-t-il des valeurs manquantes dans le tableau à analyses ? Si oui, comment les gérer ?
\end{enumerate}

\hypertarget{nature-des-variables}{%
\section{Nature des variables}\label{nature-des-variables}}

On distingue les variables qualitatives des variables quantitatives. Cependant, cette distinction n'est pas absolument évidente.

\hypertarget{variables-quantitatives}{%
\subsection{Variables quantitatives}\label{variables-quantitatives}}

Une variable \textbf{quantitative} permet de mesurer une grandeur (quantité). Elle peut être :

\begin{itemize}
\item
  \textbf{discrète} (un nombre fini de valeurs possibles). \emph{Exemple : un nombre de logements}
\item
  \textbf{continue} (\emph{a priori}, toutes les valeurs possibles). \emph{Exemple : une taille, une surface, un revenu}
\end{itemize}

\hypertarget{variables-qualitatives}{%
\subsection{Variables qualitatives}\label{variables-qualitatives}}

Une variable \textbf{qualitative} indique des caractéristiques qui ne sont pas des quantités. Les différentes valeurs que peut prendre cette variable sont appelées les catégories ou modalités (\texttt{levels} dans R). Elle peut être :

\begin{itemize}
\item
  \textbf{ordonnée} (exprimer un ordre). \emph{Exemple : ``petit - moyen - grand''}
\item
  \textbf{non ordonnée}. \emph{Exemple : une couleur, un groupe sanguin\ldots{}}
\end{itemize}

\hypertarget{entre-les-deux}{%
\subsection{Entre les deux}\label{entre-les-deux}}

Les variables binaires (ou boléennes) peuvent être considérées soit comme quantitatives, soit comme qualitatives.

Les variables ordinales peuvent être codées quantitativement, comme par exemple un indice de satisfaction dans une enquête :
- 0 : Pas satisfait du tout
- 1 : Plutôt pas satisfait
- 2 : Plutôt satisfait
- 3 : Très satisfait
Dans un tel cas, ce n'est pas très élégant car ça dépebd du codage choisi, mais on peut calculer des indices de satisfaction ``moyens'' par exemple pour comparer des groupes.

À l'inverse, on peut discrétiser une variable quantitative pour la transformer en variable qualitative, avec la fonction \texttt{cut} et en précisant les bornes du découpage. En discrétisant, on perd une part de l'information (l'information intra-classe), donc c'est à éviter autant que possible en privilégiant les méthodes applicables aux variables quantitatives.

\hypertarget{le-package-factominer}{%
\section{Le package FactoMineR}\label{le-package-factominer}}

Il existe de nombreux packages R pour les analyses multivariées : \texttt{ade4}, \texttt{vegan}, \texttt{cluster}, \texttt{Hmisc}, etc. Il a bien fallu choisir.

Le package \texttt{FactoMineR} est décrit dans \href{https://www.jstatsoft.org/index.php/jss/article/view/v025i01/v25i01.pdf}{cet article du J. Stat. Software de 2008}. Il a donc fait ses preuves. Il est très employé : en décembre 2018, \href{}{l'article est cité plus de 1800 fois depuis 2008 dans Google Scholar}\url{https://scholar.google.fr/scholar?as_q=factominer\&as_epq=\&as_oq=\&as_eq=\&as_occt=any\&as_sauthors=husson\&as_publication=\&as_ylo=\&as_yhi=\&hl=fr\&as_sdt=0\%2C5}.

Il permet de réaliser toutes les analyses multivariées usuelles et fournit de nombreuses aides graphiques à l'interprétation \(\Rightarrow\) ``école française de l'analyse multivariée''.

Deux de ses fonctionnalités sont particulièrement intéressantes :

\begin{itemize}
\tightlist
\item
  La possibilité de projeter des variables ou des individus supplémentaires.
\item
  La simplicité d'utilisation avec le package \href{http://math.agrocampus-ouest.fr/infoglueDeliverLive/developpement/missMDA}{missMDA} pour imputer les valeurs manquantes.
\end{itemize}

La documentation associée est très riche, dont une bonne partie en français. Il y a en particulier :

\begin{itemize}
\tightlist
\item
  \href{http://factominer.free.fr/}{Un site web}
\item
  \href{https://www.youtube.com/playlist?list=PLnZgp6epRBbTsZEFXi_p6W48HhNyqwxIu}{Des tutos en vidéo}
\end{itemize}

Il existe un module complémentaire pour améliorer les graphiques de sortie : \href{http://factominer.free.fr/graphs/factoshiny-fr.html}{Factoshiny}.

La plupart des méthodes qui ne sont pas comprises dans \texttt{FactoMineR} peuvent être mises en oeuvre avec le package \texttt{ade4}, en particulier pour l'analyse discriminante et les analyses à plusieurs tableaux (co-inertie, ACP sur variables instrumentales, analyse canonique des correspondences, analyse RLQ).

\hypertarget{bien-commencer}{%
\chapter{Bien commencer}\label{bien-commencer}}

\hypertarget{creer-un-projet-sous-rstudio-pour-vous-permettre-de-recenser-vos-travaux.}{%
\section{Créer un projet sous Rstudio pour vous permettre de recenser vos travaux.}\label{creer-un-projet-sous-rstudio-pour-vous-permettre-de-recenser-vos-travaux.}}

Pourquoi travailler avec les projets Rstudio plutôt que les scripts R ?

\begin{itemize}
\tightlist
\item
  Cela permet la portabilité : le répertoire de travail par défaut d'un projet est le répertoire où est ce projet. Si vous transmettez celui-ci à un collègue, le fait de lancer un programme ne dépend pas de l'arborescence de votre machine.
\end{itemize}

\begin{quote}
\textbf{Fini les \texttt{setwd("chemin/qui/marche/uniquement/sur/mon/poste")} !}
\end{quote}

\begin{itemize}
\tightlist
\item
  Toujours sur la portabilité, un projet peut être utilisé avec un outil comme \texttt{packrat} qui va vous intégrer en interne au projet l'ensemble des packages nécessaires au projet. Cela permet donc à votre collègue à qui vous passez votre projet de ne pas avoir à les installer et, surtout, si vous mettez à jour votre environnement R, votre projet restera toujours avec les versions des packages avec lesquelles vous avez fait tourner votre projet à l'époque. Cela évite d'avoir à subir les effets d'une mise à jour importante d'un package qui casserait votre code.
\end{itemize}

Pour activer \texttt{packrat} sur un projet, aller dans \texttt{Tools/Project\ Options-\textgreater{}Packrat}

\href{https://www.rstudio.com/resources/webinars/managing-package-dependencies-in-r-with-packrat/}{En savoir plus sur Packrat}

\includegraphics[width=5.20833in,height=\textheight]{images/creerprojet4.png}

\begin{itemize}
\item
  Cela permet de se forcer à travailler en mode projet : on intègre à un seul endroit tout ce qui est lié à un projet : données brutes, données retravaillées, scripts, illustrations, documentations, publications\ldots{} et donc y compris les packages avec \texttt{packrat}.
\item
  On peut travailler sur plusieurs projets en même temps, Rstudio ouvre autant de sessions que de projets dans ce cas.
\item
  Les projets Rstudio intègrent une interface avec les outils de gestion de version Git et SVN. Cela veut dire que vous pouvez versionniser votre projet et l'héberger simplement comme répertoire sur des plateformes de gestion de code telle que Github ou Gitlab.
\end{itemize}

\textbf{Pour créer un projet : }

\begin{itemize}
\tightlist
\item
  Cliquez sur \emph{Project} en haut à droite puis \emph{New Project}.
\end{itemize}

\includegraphics[width=5.20833in,height=\textheight]{images/creerprojet1.png}

\begin{itemize}
\tightlist
\item
  Cliquez sur \emph{New Directory}.
\end{itemize}

\includegraphics[width=5.20833in,height=\textheight]{images/creerprojet2.png}

\hypertarget{integrer-vos-donnees}{%
\section{Intégrer vos données}\label{integrer-vos-donnees}}

Une bonne pratique est de créer un sous répertoire \texttt{/data} pour stocker les données sur lesquelles vous aurez à travailler.

Vous pouvez le faire depuis l'explorateur de fichier de votre système d'exploitation ou directement à partir de l'explorateur de fichier de RStudio.

\includegraphics[width=5.20833in,height=\textheight]{images/creerprojet3.png}

Cela marche bien quand on a un seul type de données, mais en général on va avoir à travailler sur des données brutes que l'on va retravailler ensuite et vouloir stocker à part. Si par la suite vous souhaitez avoir des exemples de bonnes pratiques sur comment structurer vos données, vous pouvez vous référer au \href{http://r-pkgs.had.co.nz/data.html}{chapitre data} du livre d'Hadley Wickham sur la construction de packages R (tout package R étant aussi un projet !).

\hypertarget{creer-votre-arborescence-de-projet}{%
\section{Créer votre arborescence de projet}\label{creer-votre-arborescence-de-projet}}

\begin{itemize}
\tightlist
\item
  Créer un répertoire \texttt{/src} ou vous mettrez vos scripts R.
\item
  Créer un répertoire \texttt{/figures} ou vous mettrez vos illustrations issues de R.
\end{itemize}

\hypertarget{activer-les-packages-necessaires}{%
\section{Activer les packages nécessaires}\label{activer-les-packages-necessaires}}

Commencer par rajouter un script dans le répertoire \texttt{/src} à votre projet qui commencera par :

\begin{itemize}
\item
  activer l'ensemble des packages nécessaires
\item
  charger les données dont vous aurez besoin.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{ (tidyverse)}
\KeywordTok{library}\NormalTok{ (FactoMineR)}
\KeywordTok{library}\NormalTok{ (factoextra)}
\KeywordTok{library}\NormalTok{ (GGally)}
\KeywordTok{library}\NormalTok{ (ggExtra)}
\KeywordTok{library}\NormalTok{ (data.table)}
\KeywordTok{library}\NormalTok{ (DT)}
\KeywordTok{library}\NormalTok{ (grid)}

\NormalTok{geoidd <-}\StringTok{ }\KeywordTok{read.csv2}\NormalTok{ (}\DataTypeTok{file =} \StringTok{"data/ACP.csv"}\NormalTok{, }\DataTypeTok{header =}\NormalTok{ T, }\DataTypeTok{encoding =} \StringTok{"latin1"}\NormalTok{)}

\NormalTok{taille <-}\StringTok{ }\KeywordTok{read.csv2}\NormalTok{ (}\StringTok{"data/Effet_taille.csv"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{,}
                     \DataTypeTok{encoding =} \StringTok{"latin1"}\NormalTok{)}

\KeywordTok{data}\NormalTok{ (iris)}

\KeywordTok{data}\NormalTok{ (hobbies)}
\end{Highlighting}
\end{Shaded}

\hypertarget{bien-structurer-ses-projets-data}{%
\section{\texorpdfstring{Bien structurer ses projets \emph{data}}{Bien structurer ses projets data}}\label{bien-structurer-ses-projets-data}}

Plusieurs documents peuvent vous inspirer sur la structuration de vos projets \emph{data} par la suite.

En voici quelques uns :

\begin{itemize}
\tightlist
\item
  \url{https://github.com/pavopax/new-project-template}
\item
  \url{https://nicercode.github.io/blog/2013-04-05-projects/}
\item
  \url{https://www.inwt-statistics.com/read-blog/a-meaningful-file-structure-for-r-projects.html}
\item
  \url{http://projecttemplate.net/architecture.html}
\end{itemize}

À partir du moment où quelques grands principes sont respectés (un répertoire pour les données brutes en lecture seule par exemple), le reste est surtout une question d'attirance plus forte pour l'une ou l'autre solution. L'important est de vous tenir ensuite à conserver toujours la même arborescence dans vos projets afin de vous y retrouver plus simplement.

\hypertarget{lacp}{%
\chapter{L'ACP}\label{lacp}}

\hypertarget{principe-de-lacp}{%
\section{Principe de l'ACP}\label{principe-de-lacp}}

\hypertarget{type-de-donnees}{%
\subsection{Type de données}\label{type-de-donnees}}

On dispose d'un tableau de \(n\) lignes et \(p\) colonnes actives qui sont uniquement des variables quantitatives (au sens large, des binaires codées 0/1 ou des variables ordinales passent).

\includegraphics{images/DF1.png}

\hypertarget{objectifs-1}{%
\subsection{Objectifs}\label{objectifs-1}}

Une ACP peut permettre de :

\begin{itemize}
\tightlist
\item
  Résumer l'information.
\item
  Identifier les corrélations entre variables actives.
\item
  Identifier les proximités entre les individus.
\end{itemize}

\hypertarget{methode}{%
\subsection{Méthode}\label{methode}}

L'ACP va déterminer, dans un espace à \(p\) dimensions (sous l'hypothèse qu'aucune des variables n'est une combinaison linéaire des autres), l'axe le long duquel les points représentant les individus sont les plus ``étalés''. Cet axe \(F_1\) est une combinaison linéaire des variables de départ.

Dans l'exemple graphique ci-dessous et en 2D, la dispersion des points est essentiellement le long de l'axe bleu. L'axe rouge est orthogonal au bleu. Dans le repère \((O, x, y)\), la variance est à peu près équivalente sur \(x\) et sur \(y\). A l'inverse, dans le repère constitué des axes de couleur, la variance est portée essentiellement sur le bleu tandis que le rouge ne porte qu'une faible partie de l'inertie du nuage de point. En gros, l'axe bleu est la première composante principale, généralement notée \(PC_1\) ou \(F_1\), et le rouge \(PC_2\) ou \(F_2\).

\includegraphics{exploration_avancee_files/figure-latex/acp_1-1.pdf}

Ce changement de repère peut être visualisé ainsi :

\includegraphics{exploration_avancee_files/figure-latex/acp_2-1.pdf}

Dans ce nouveau repère, l'essentiel de la dispersion des points peut être ``résumé'' par leur position sur \(F_1\).

La \emph{variance} du nuage de points caractérise sa dispersion. C'est la moyenne, sur l'ensemble des points, des carrés des distances au centre d'inertie du nuage. D'après le théorème de Pythagore, elle peut être décomposée en composantes orthogonales car \(d^2=d_1^2+d_2^2\).

\(V={\frac 1n}\sum _{{i=1}}^{n}(d_{i})^{2}\\  ={\frac 1n}\sum _{{i=1}}^{n}[(d_{1i})^{2}+(d_{2i})^{2}]\\  ={\frac 1n}\sum _{{i=1}}^{n}(d_{1i})^{2}+{\frac 1n}\sum _{{i=1}}^{n}(d_{2i})^{2}\\  =V_1+V_2\)

Lors du changement de repère, on a conservé la variance totale du nuage de points, mais au lieu d'être répartie également entre les variables \(x\) et \(y\), elle est concentrée sur \(F_1\).

Pour un nombre de variables \(p>2\), on généralise. \(F_1\) est l'axe qui porte le plus d'inertie, puis \(F_2\) est, dans le sous-espace orthogonal à \(F_1\), celui qui porte le plus d'inertie, et ainsi de suite. Le nombre total d'axes est \(p\) (sauf à avoir des variables qui sont des combinaisons linéaires les unes des autres, ce qui intervient par exemple quand la somme des colonnes fait 100\%).

Faire une ACP revient donc à effectuer un changement de repère. Dans notre \emph{dataframe} de départ, chaque colonne peut être vue comme une coordonnée de chacun des individus. Ce n'est pas un repère orthonormé car les variables sont plus ou moins corrélées les unes aux autres. Quand on représente le nuage de points dans le repère \((O, F_1, F_2)\), les axes sont indépendants (corrélation nulle).

En d'autres termes, l'ACP consiste à construire un nouvel espace vectoriel orthonormé (les variables construites sont non-corrélées 2 à 2) de même dimension que l'espace de départ, mais où l'inertie sera concentrée sur les premiers \emph{axes factoriels}. Mathématiquement, cela conduit à diagonaliser la matrice de variance-covariance ; les valeurs propres correspondent à la part de l'inertie totale portée par chaque axe factoriel.

\hypertarget{centrer---reduire}{%
\subsection{Centrer - réduire ?}\label{centrer---reduire}}

Si l'on a des variables de dispersion (variance) très différentes, ou d'unités différentes, en général il fait centrer (retrancher la moyenne) et réduire (diviser par l'écart-type) chacune des variables avant d'effectuer l'ACP. Dans ce cas chacune des variables a la même importance (variance de 1) \(\Rightarrow\) l'inertie du nuage vaut \(p\).

C'est l'option par défaut dans la fonction \texttt{PCA} de FactoMineR (\texttt{scale.unit\ =\ TRUE}), qui réalise donc une ACP dite ``normée''.

\textbf{Note :} Les espaces des variables et des individus ne sont pas les mêmes en ACP \(\Rightarrow\) on ne peut pas les représenter simultanément. Dans les autres analyses, on le peut.

\hypertarget{lacp-avec-factominer}{%
\section{L'ACP avec FactoMiner}\label{lacp-avec-factominer}}

\hypertarget{ressources}{%
\subsection{Ressources}\label{ressources}}

\begin{itemize}
\tightlist
\item
  Une \href{https://www.youtube.com/watch?v=1QPRsg3Bxok}{explication en vidéo par l'auteur du package FactoMiner}
\item
  Un \href{http://factominer.free.fr/course/doc/AnaDo_ACP_Facto_Decathlon_Markdown.pdf}{tuto associé} en pdf.
\item
  Des \href{http://www.math.univ-toulouse.fr/~besse/Wikistat/pdf/st-m-explo-acp}{éléments plus généraux sur l'ACP}.
\end{itemize}

\hypertarget{exemple}{%
\subsection{Exemple}\label{exemple}}

\hypertarget{donnees-utilisees}{%
\subsubsection{Données utilisées}\label{donnees-utilisees}}

\begin{itemize}
\tightlist
\item
  Données communales téléchargées sur \href{http://geoidd.developpement-durable.gouv.fr/geoclip_stats_o3/index.php?profil=FR\#s=2012;v=map1;i=ocs.p_surf_c1;l=fr}{Géoïdd} et converties en format \emph{.csv} (\textbf{attention aux valeurs N/A ou autres dans le fichier Excel qui peuvent parasiter l'importation de données}).
\item
  Les individus statistiques sont les communes (lignes) et les variables (colonnes) différents indicateurs décrivant ces communes.
\item
  Objectif : voir quels indicateurs différencient le plus les communes, et quelles sont les communes qui s'écartent le plus de la moyenne.
\item
  Utilisation de variables qualitatives supplémentaires pour compléter la description (présence d'un agenda21 et d'un PPRN).
\end{itemize}

\hypertarget{importation-et-exploration-rapide}{%
\subsubsection{Importation et exploration rapide}\label{importation-et-exploration-rapide}}

Les données sont dans le fichier \emph{ACP.csv}.

Le fait d'affecter les code géographiques comme \texttt{row.names} du dataframe permet de mieux identifier les individus sur les graphiques (et les sorties) par la suite.

ATTENTION, certaines fonctions du package \texttt{dplyr} du tidyverse, comme \texttt{mutate}, suppriment les noms des lignes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat <-}\StringTok{ }\NormalTok{geoidd }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{ (}\OperatorTok{-}\NormalTok{code, }\OperatorTok{-}\NormalTok{communes)}
\KeywordTok{row.names}\NormalTok{ (dat) <-}\StringTok{ }\NormalTok{geoidd}\OperatorTok{$}\NormalTok{code}

\NormalTok{dat}\OperatorTok{$}\NormalTok{agd21 <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{ (}\KeywordTok{paste}\NormalTok{ (}\StringTok{"Agenda21 "}\NormalTok{, (dat}\OperatorTok{$}\NormalTok{part_agenda21 }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{) }\OperatorTok{+}\StringTok{ }\DecValTok{0}\NormalTok{))}
\NormalTok{dat <-}\StringTok{ }\NormalTok{dat }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{ (}\OperatorTok{-}\StringTok{ }\NormalTok{part_agenda21) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{na.omit}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Matrice de corrélations sur les variables quantitatives :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{ (}\OperatorTok{-}\NormalTok{PPRN, }\OperatorTok{-}\NormalTok{agd21) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{cor}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{round}\NormalTok{ (}\DataTypeTok{digits =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Densite tx_emploi part_artif part_proprio ind_vieill
## Densite         1.00      0.09       0.68        -0.35      -0.06
## tx_emploi       0.09      1.00       0.25        -0.34       0.07
## part_artif      0.68      0.25       1.00        -0.48      -0.10
## part_proprio   -0.35     -0.34      -0.48         1.00       0.03
## ind_vieill     -0.06      0.07      -0.10         0.03       1.00
\end{verbatim}

Tableau croisé sur les variables qualitatives :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{table}\NormalTok{ (dat}\OperatorTok{$}\NormalTok{agd21, dat}\OperatorTok{$}\NormalTok{PPRN)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               
##                0 - Absence de PPRN 1 - PPRN prescrit 2 - PPRN approuvé
##   Agenda21  0                21768              2321              8306
##   Agenda21  1                 2916               136              1063
##   Agenda21  NA                   0                 0                 0
\end{verbatim}

On remarque dans un premier temps que les corrélations ne sont pas très élevées entre les variables. La corrélation la plus élevée est celle entre la densité de population et la part de terres artificialisées.
Le lien entre les variables \emph{PPRN} et \emph{Agenda21} est peu évident avec le tableau de fréquences.

On peut utiliser les fonctions vues dans le module 3 pour explorer les données :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{select}\NormalTok{ (dat, }\OperatorTok{-}\NormalTok{PPRN, }\OperatorTok{-}\NormalTok{agd21) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggpairs}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_6-1.pdf}

\hypertarget{realiser-lacp}{%
\subsubsection{Réaliser l'ACP}\label{realiser-lacp}}

Pour voir l'aide : \texttt{?PCA}.

On voit que par défaut les variables sont centrées - réduites et que les valeurs manquantes sont remplacées par la moyenne de la colonne à laquelle elles appartiennent. Il est important de se questionner sur la pertinence de ces options ``par défaut''.

Réalisation de l'ACP :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acp <-}\StringTok{ }\KeywordTok{PCA}\NormalTok{ (}\DataTypeTok{X =}\NormalTok{ dat, }\DataTypeTok{quali.sup =} \KeywordTok{c}\NormalTok{ (}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{), }\DataTypeTok{graph =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

La fonction \texttt{PCA} retourne un objet de type liste (de liste), qui contient toutes les informations nécessaires à l'interprétation des résultats et leur utilisation : on y retrouve notamment, pour les individus \textbf{et} pour les variables, sur chacun des axes :

\begin{itemize}
\tightlist
\item
  Les coordonnées factorielles (\emph{coord}).
\item
  La qualité de représentation (\emph{cos2}) sur chaque axe.
\item
  La contribution à la formation de l'axe (c'est à dire la part de variance de l'axe portée par l'individu / la variable).
\end{itemize}

Pour accéder aux résultats de l'ACP, on peut voir les objets contenus dans cette liste :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{names}\NormalTok{ (acp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "eig"       "var"       "ind"       "svd"       "quali.sup" "call"
\end{verbatim}

Chacun de ces sous-objets (par exemple \texttt{acp\$ind}) contient à son tour des éléments :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{names}\NormalTok{ (acp}\OperatorTok{$}\NormalTok{ind)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "coord"   "cos2"    "contrib" "dist"
\end{verbatim}

Pour tout visualiser d'un coup, on peut utiliser la fonction \texttt{str} :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{ (acp)}
\end{Highlighting}
\end{Shaded}

L'élément \texttt{eig} donne les valeurs propres de la matrice de variance-covariance, autrement dit la part d'inertie portée par chacun des axes factoriels. Pour accéder aux coordonnées factorielles des individus, on apppelle l'élément \emph{coord} de l'élément \emph{ind} de l'objet \emph{acp}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{ (acp}\OperatorTok{$}\NormalTok{ind}\OperatorTok{$}\NormalTok{coord, }\DataTypeTok{n =} \DecValTok{10}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{round}\NormalTok{ (}\DataTypeTok{digits =} \DecValTok{2}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{datatable}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_11-1.pdf}

Contributions des individus à chacun des axes :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acp}\OperatorTok{$}\NormalTok{ind}\OperatorTok{$}\NormalTok{contrib }\OperatorTok{%>%}\StringTok{ }\KeywordTok{round}\NormalTok{ (}\DataTypeTok{digits =} \DecValTok{5}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{datatable}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_12-1.pdf}

Recherche des individus qui contribuent le plus aux axes. Pas mal de fonctions du tidyverse font disparaître les noms des lignes \(\Rightarrow\) on les stocke provisoirement dans une variable avec la fonction \texttt{rownames\_to\_column()} puis on les ré-attribue avec la fonction réciproque \texttt{column\_to\_rownames()}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acp}\OperatorTok{$}\NormalTok{ind}\OperatorTok{$}\NormalTok{contrib }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{round}\NormalTok{ (}\DataTypeTok{digits =} \DecValTok{5}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{as.data.frame}\NormalTok{ () }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{rownames_to_column}\NormalTok{ (}\DataTypeTok{var =} \StringTok{'Commune'}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{ (}\DataTypeTok{somme =} \KeywordTok{rowSums}\NormalTok{ (}\KeywordTok{select}\NormalTok{(., }\KeywordTok{starts_with}\NormalTok{ (}\StringTok{"Dim"}\NormalTok{)))) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{ (somme }\OperatorTok{>}\StringTok{ }\FloatTok{0.2}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{column_to_rownames}\NormalTok{ (}\DataTypeTok{var =} \StringTok{'Commune'}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{datatable}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_13-1.pdf}

En ordonnant le tableau selon les différentes composantes principales, on peut identifier les communes qui contribuent le plus à chacun des axes.

On peut également utiliser les fonctions génériques \texttt{summary} et \texttt{plot} (ou \texttt{plot.PCA} ; cf. \texttt{?plot.PCA}) pour aborder ce nouvel objet.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{ (acp)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_14-1.pdf}

\hypertarget{nombre-daxes-a-retenir}{%
\subsubsection{Nombre d'axes à retenir}\label{nombre-daxes-a-retenir}}

On accède aux valeurs propres par l'objet \texttt{acp\$eig} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acp}\OperatorTok{$}\NormalTok{eig}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        eigenvalue percentage of variance cumulative percentage of variance
## comp 1  2.1546177              43.092354                          43.09235
## comp 2  1.0908956              21.817913                          64.91027
## comp 3  0.8865747              17.731493                          82.64176
## comp 4  0.5718572              11.437144                          94.07890
## comp 5  0.2960548               5.921095                         100.00000
\end{verbatim}

On peut représenter graphiquement les valeurs propres (« éboulis » des valeurs propres).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eig <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{ (acp}\OperatorTok{$}\NormalTok{eig)}
\NormalTok{mm <-}\StringTok{ }\KeywordTok{mean}\NormalTok{ (eig}\OperatorTok{$}\StringTok{`}\DataTypeTok{percentage of variance}\StringTok{`}\NormalTok{) }\OperatorTok{/}\StringTok{ }\DecValTok{100}

\KeywordTok{ggplot}\NormalTok{ (eig, }\KeywordTok{aes}\NormalTok{ (}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(eig), }\DataTypeTok{weight =} \StringTok{`}\DataTypeTok{percentage of variance}\StringTok{`}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{ (}\DataTypeTok{fill =} \StringTok{"grey20"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{ (}\StringTok{"Valeurs propres"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{theme}\NormalTok{ (}\DataTypeTok{axis.title.x =} \KeywordTok{element_blank}\NormalTok{(), }\DataTypeTok{axis.title.y =} \KeywordTok{element_blank}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_y_continuous}\NormalTok{ (}\DataTypeTok{labels =} \ControlFlowTok{function}\NormalTok{(x) }\KeywordTok{paste0}\NormalTok{(x, }\StringTok{"%"}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_hline}\NormalTok{ (}\DataTypeTok{yintercept =} \DecValTok{20}\NormalTok{, }\DataTypeTok{colour=}\StringTok{"red"}\NormalTok{, }\DataTypeTok{linetype=}\StringTok{"dashed"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_16-1.pdf}

Pour choisir le nombre d'axes à conserver, on peut utiliser plusieurs critères :

\begin{itemize}
\tightlist
\item
  Critère de l'inertie moyenne : on retient les axes qui représentent plus d'inertie que la moyenne (=inertie totale/nombre de variables). Cette inertie vaut \textbf{1} dans le cas de l'ACP normée (soit 20\% dans notre cas). Cela revient à se dire qu'on ne prend que les nouvelles variables qui portent plus d'inertie que les variables initiales.
\item
  Critère du coude : on retient les premiers axes jusqu'à oberver un ``décrochage'' dans l'éboulis des valeurs propres. On peut l'objectiver par le calcul des différences secondes entre valeurs propres.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acp}\OperatorTok{$}\NormalTok{eig }\OperatorTok{%>%}\StringTok{ }\KeywordTok{diff}\NormalTok{ () }\OperatorTok{%>%}\StringTok{ }\KeywordTok{diff}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         eigenvalue percentage of variance
## comp 3  0.85940109             17.1880217
## comp 4 -0.11039646             -2.2079291
## comp 5  0.03891498              0.7782996
##        cumulative percentage of variance
## comp 3                         -4.086420
## comp 4                         -6.294349
## comp 5                         -5.516049
\end{verbatim}

Ici, le critère de l'inertie moyenne incite à retenir les 2 premiers axes alors que le critère du coude en retiendrait 3 (la dérivée seconde change de signe entre la 3e et 4e valeur propre). Généralement, on prend le critère le plus parcimonieux pour s'épargner du travail ensuite !

\hypertarget{interpreter-les-axes}{%
\subsubsection{Interpréter les axes}\label{interpreter-les-axes}}

\begin{itemize}
\tightlist
\item
  Rappel : les axes factoriels sont des combinaisons linéaires des variables initiales. On regarde donc l'importance de ces variables initiales dans les différents axes pour leur \emph{donner du sens}.
\item
  On doit regarder trois grandeurs pour interpréter (dans cet ordre) :

  \begin{itemize}
  \tightlist
  \item
    Contribution
  \item
    Qualité de représentation
  \item
    Coordonnée
  \end{itemize}
\end{itemize}

On visualise le \textbf{cercle des corrélations}. En ACP, qualité et contribution dépendent directement de la coordonnée : il suffit que celle-ci soit élevée pour que la qualité de représentation soit bonne et la contribution forte.
Pour obtenir ce graphique, on utilise la fonction \texttt{plot.PCA}, avec l'argument \texttt{choix\ =\ "var"}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.PCA}\NormalTok{ (acp, }\DataTypeTok{choix =} \StringTok{"var"}\NormalTok{, }\DataTypeTok{col.var =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_18-1.pdf}

\(\Rightarrow\) on regarde avant tout les variables proches du cercle unité.

A partir de ce cercle (sur le premier plan factoriel), on voit que :

\begin{itemize}
\tightlist
\item
  Les variables \emph{part\_artif} et \emph{Densite} sont corrélées positivement, et toutes deux négativement à \emph{part\_proprio}.
\item
  La variable \emph{ind\_vieill} est indépendante (\textasciitilde{}orthogonale) aux trois variables précédentes.
\item
  L'axe 1 porte (\textasciitilde{}synthétise) 43,1\% de l'inertie totale. Il est principalement formé par les variables \emph{part\_artif}, \emph{Densite} et \emph{part\_proprio}.
\item
  L'axe 2 porte 21,8\% de l'inertie. Il est formé par les variables \emph{ind\_vieill} et, dans une moindre mesure, \emph{tx\_emploi}.
\end{itemize}

On peut interpréter de façon plus fine grâce aux chiffres donnés par la fonction \texttt{summary}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{ (acp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## PCA(X = dat, quali.sup = c(5, 7), graph = FALSE) 
## 
## 
## Eigenvalues
##                        Dim.1   Dim.2   Dim.3   Dim.4   Dim.5
## Variance               2.155   1.091   0.887   0.572   0.296
## % of var.             43.092  21.818  17.731  11.437   5.921
## Cumulative % of var.  43.092  64.910  82.642  94.079 100.000
## 
## Individuals (the 10 first)
##                         Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2
## 01001               |  0.823 | -0.559  0.000  0.462 | -0.603  0.001  0.538
## 01002               |  0.915 | -0.795  0.001  0.756 | -0.407  0.000  0.198
## 01004               |  3.847 |  3.393  0.015  0.778 |  0.449  0.001  0.014
## 01005               |  0.741 |  0.109  0.000  0.021 | -0.476  0.001  0.413
## 01006               |  1.222 |  0.080  0.000  0.004 | -0.055  0.000  0.002
## 01007               |  0.623 |  0.219  0.000  0.124 | -0.404  0.000  0.420
## 01008               |  0.844 |  0.365  0.000  0.187 | -0.529  0.001  0.392
## 01009               |  0.851 | -0.750  0.001  0.778 | -0.263  0.000  0.096
## 01010               |  0.701 |  0.060  0.000  0.007 | -0.276  0.000  0.154
## 01011               |  0.881 | -0.480  0.000  0.296 | -0.613  0.001  0.483
##                        Dim.3    ctr   cos2  
## 01001               |  0.005  0.000  0.000 |
## 01002               |  0.118  0.000  0.017 |
## 01004               | -0.984  0.003  0.065 |
## 01005               | -0.351  0.000  0.224 |
## 01006               |  0.211  0.000  0.030 |
## 01007               | -0.254  0.000  0.167 |
## 01008               | -0.290  0.000  0.118 |
## 01009               |  0.232  0.000  0.074 |
## 01010               | -0.490  0.001  0.488 |
## 01011               | -0.164  0.000  0.034 |
## 
## Variables
##                        Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3
## Densite             |  0.784 28.554  0.615 | -0.264  6.394  0.070 |  0.392
## tx_emploi           |  0.461  9.877  0.213 |  0.616 34.798  0.380 | -0.519
## part_artif          |  0.875 35.549  0.766 | -0.149  2.049  0.022 |  0.165
## part_proprio        | -0.740 25.447  0.548 | -0.187  3.215  0.035 |  0.192
## ind_vieill          | -0.111  0.573  0.012 |  0.764 53.545  0.584 |  0.633
##                        ctr   cos2  
## Densite             17.301  0.153 |
## tx_emploi           30.330  0.269 |
## part_artif           3.070  0.027 |
## part_proprio         4.152  0.037 |
## ind_vieill          45.146  0.400 |
## 
## Supplementary categories
##                          Dist     Dim.1    cos2  v.test     Dim.2    cos2
## 0 - Absence de PPRN |   0.243 |  -0.235   0.932 -44.179 |   0.003   0.000
## 1 - PPRN prescrit   |   0.399 |   0.365   0.836  12.756 |  -0.112   0.078
## 2 - PPRN approuvé   |   0.543 |   0.523   0.929  40.018 |   0.020   0.001
## Agenda21  0         |   0.052 |  -0.048   0.829 -17.414 |   0.009   0.029
## Agenda21  1         |   0.412 |   0.375   0.829  17.414 |  -0.070   0.029
##                      v.test     Dim.3    cos2  v.test  
## 0 - Absence de PPRN   0.916 |   0.024   0.009   6.937 |
## 1 - PPRN prescrit    -5.482 |  -0.021   0.003  -1.145 |
## 2 - PPRN approuvé     2.163 |  -0.057   0.011  -6.775 |
## Agenda21  0           4.545 |  -0.015   0.083  -8.598 |
## Agenda21  1          -4.545 |   0.119   0.083   8.598 |
\end{verbatim}

La fonction \texttt{dimdesc} donne les variables les plus liées à chacun des axes.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{dimdesc}\NormalTok{ (acp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $Dim.1
## $Dim.1$quanti
##              correlation       p.value
## part_artif     0.8751772  0.000000e+00
## Densite        0.7843627  0.000000e+00
## tx_emploi      0.4613266  0.000000e+00
## ind_vieill    -0.1111117 1.236263e-100
## part_proprio  -0.7404659  0.000000e+00
## 
## $Dim.1$quali
##                R2      p.value
## PPRN  0.054080975 0.000000e+00
## agd21 0.008306086 3.445294e-68
## 
## $Dim.1$category
##                            Estimate      p.value
## PPRN=2 - PPRN approuvé    0.3055307 0.000000e+00
## agd21=Agenda21  1         0.2115150 3.445294e-68
## PPRN=1 - PPRN prescrit    0.1470988 2.415332e-37
## agd21=Agenda21  0        -0.2115150 3.445294e-68
## PPRN=0 - Absence de PPRN -0.4526296 0.000000e+00
## 
## 
## $Dim.2
## $Dim.2$quanti
##              correlation       p.value
## ind_vieill     0.7642764  0.000000e+00
## tx_emploi      0.6161225  0.000000e+00
## part_artif    -0.1494941 1.843625e-181
## part_proprio  -0.1872759 2.069053e-285
## Densite       -0.2641013  0.000000e+00
## 
## $Dim.2$quali
##                 R2      p.value
## PPRN  0.0008706053 1.245555e-07
## agd21 0.0005657106 5.489230e-06
## 
## $Dim.2$category
##                           Estimate      p.value
## agd21=Agenda21  0       0.03927776 5.489230e-06
## PPRN=2 - PPRN approuvé  0.04945204 3.051304e-02
## agd21=Agenda21  1      -0.03927776 5.489230e-06
## PPRN=1 - PPRN prescrit -0.08224271 4.171741e-08
## 
## 
## $Dim.3
## $Dim.3$quanti
##              correlation       p.value
## ind_vieill     0.6326567  0.000000e+00
## Densite        0.3916457  0.000000e+00
## part_proprio   0.1918639 1.002604e-299
## part_artif     0.1649901 4.054263e-221
## tx_emploi     -0.5185559  0.000000e+00
## 
## $Dim.3$quali
##                R2      p.value
## agd21 0.002025068 7.791424e-18
## PPRN  0.001395099 8.566069e-12
## 
## $Dim.3$category
##                             Estimate      p.value
## agd21=Agenda21  1         0.06699392 7.791424e-18
## PPRN=0 - Absence de PPRN  0.04171611 3.957733e-12
## PPRN=2 - PPRN approuvé   -0.03877158 1.223326e-11
## agd21=Agenda21  0        -0.06699392 7.791424e-18
\end{verbatim}

On peut également regarder la projection des individus dans le plan. Ce n'est pas toujours très informatif, ça peut permettre de repérer :
- Des groupes d'individus quand il existe des discontinuités.
- Des valeurs extrêmes qui peuvent contribuer exagérément aux axes (donc qui nuisent à la représentation du reste des individus).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.PCA}\NormalTok{ (acp, }\DataTypeTok{choix =} \StringTok{"ind"}\NormalTok{, }\DataTypeTok{col.ind =} \StringTok{"lightblue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_21-1.pdf}

N'oubliez pas de consulter l'aide des fonctions présentées pour plus d'options.

\hypertarget{les-variables-supplementaires}{%
\subsubsection{Les variables supplémentaires}\label{les-variables-supplementaires}}

Dans toutes les analyses factorielles, on distingue les \textbf{variables actives}, qui participent de la création du nouvel espace vectoriel, des \textbf{variables supplémentaires}, que l'on projette \emph{a posteriori} sur cet espace, mais qui n'interviennent pas dans la construction des variables synthétiques.

\begin{itemize}
\tightlist
\item
  Elles peuvent être qualitatives ou quantitatives.
\item
  Elles sont projetée sur l'espace des variables (variable continue) ou des individus (qualitative).
\item
  Elles ne rentrent pas dans la matrice qui sert à la définition des axes.
\item
  Elles sont utiles pour voir la corrélation d'une variable (une classe d'individus par exemple) avec toutes les variables simultanément
\end{itemize}

Dans la fonction PCA, on désigne les variables supplémentaires avec les arguments \texttt{quali.sup} ou \texttt{quanti.sup} ; attention, on les désigne par le numéro de colonne de la variable.

\(\Rightarrow\) Pas lien entre le PPRN et les autres variables : elles se projettent au centre du nuage de points. Les communes disposant d'un PPRN ou d'un Agenda21 n'ont donc pas de caractéristiques particulières.

On peut utiliser le paramètre \texttt{select} pour mettre en évidence certains individus ou variables en fonction de leur contribution ou qualité de représentation. Par exemple \texttt{select\ =\ "contrib\ 20"} permet de n'afficher les étiquettes que des individus qui contribuent le plus aux deux axes représent

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.PCA}\NormalTok{ (acp, }\DataTypeTok{choix =} \StringTok{"ind"}\NormalTok{, }\DataTypeTok{select =} \StringTok{"contrib 20"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_22-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.PCA}\NormalTok{ (acp, }\DataTypeTok{choix =} \StringTok{"ind"}\NormalTok{, }\DataTypeTok{select =} \StringTok{"cos2 20"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_22-2.pdf}

\hypertarget{reperer-un-effet-taille}{%
\subsection{Repérer un effet taille}\label{reperer-un-effet-taille}}

L'effet taille se recontre assez fréquemment quand on réalise une ACP : il se manifeste par :

\begin{itemize}
\tightlist
\item
  Toutes les variables sont de même signe sur le premier axe factoriel (donc elles sont toutes corrélées positivement entre elles) et celui-ci contient une très grand part de l'inertie.
\item
  Dans ce cas, l'axe 1 constitue un \textbf{gradient} : il permet de classer les individus du plus ``petit'' au plus ``grand'', sur toutes les variables simultanément.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{taille <-}\StringTok{ }\KeywordTok{read.csv2}\NormalTok{ (}\StringTok{"data/Effet_taille.csv"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{,}
                     \DataTypeTok{encoding =} \StringTok{"latin1"}\NormalTok{)}
\NormalTok{t <-}\StringTok{ }\KeywordTok{PCA}\NormalTok{ (}\KeywordTok{na.omit}\NormalTok{ (taille[,}\OperatorTok{-}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)]), }\DataTypeTok{graph =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{plot.PCA}\NormalTok{ (t, }\DataTypeTok{choix =} \KeywordTok{c}\NormalTok{ (}\StringTok{"var"}\NormalTok{), }\DataTypeTok{col.var =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acp_23-1.pdf}

Ce type de configuration peut décevoir quand on ne s'y attend pas. Cependant, il peut y avoir un intérêt car l'axe \(F_1\) synthétise, de manière objective et multidimensionnelle, le lien entre les variables. Ici, revenus, diplômes et statut de cadre sont très liés. Si l'on voulait étudier si ces variables sont corrélées à d'autres caractéristiques des individus, plutôt que de faire 3 analyses semblables, ou de choisir une de ces 3 variables, on pourrait prendre les coordonnées des individus sur \(F_1\) (\texttt{t\$ind\$coord{[},\ 1}) comme variable de synthèse.

\hypertarget{exercice}{%
\section{Exercice}\label{exercice}}

A partir du \texttt{dataframe} \emph{iris} inclus dans R :

\begin{itemize}
\tightlist
\item
  Explorer rapidement le jeu de données. Quel est le type des variables ?
\item
  Réalisez une ACP sur ce jeu de données.
\item
  Interprétez les résultats obtenus.
\item
  Inclure la variable ``Species'' dans l'analyse en tant que variable qualitative supplémentaire.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ (}\StringTok{"iris"}\NormalTok{)}
\KeywordTok{ggpairs}\NormalTok{ (iris)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/exercice02acp-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acp.iris <-}\StringTok{ }\KeywordTok{select}\NormalTok{ (iris, }\OperatorTok{-}\NormalTok{Species) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{PCA}\NormalTok{()}
\KeywordTok{summary}\NormalTok{ (acp.iris)}
\NormalTok{## }
\NormalTok{## Call:}
\NormalTok{## PCA(X = .) }
\NormalTok{## }
\NormalTok{## }
\NormalTok{## Eigenvalues}
\NormalTok{##                        Dim.1   Dim.2   Dim.3   Dim.4}
\NormalTok{## Variance               2.918   0.914   0.147   0.021}
\NormalTok{## % of var.             72.962  22.851   3.669   0.518}
\NormalTok{## Cumulative % of var.  72.962  95.813  99.482 100.000}
\NormalTok{## }
\NormalTok{## Individuals (the 10 first)}
\NormalTok{##                  Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2  }
\NormalTok{## 1            |  2.319 | -2.265  1.172  0.954 |  0.480  0.168  0.043 |}
\NormalTok{## 2            |  2.202 | -2.081  0.989  0.893 | -0.674  0.331  0.094 |}
\NormalTok{## 3            |  2.389 | -2.364  1.277  0.979 | -0.342  0.085  0.020 |}
\NormalTok{## 4            |  2.378 | -2.299  1.208  0.935 | -0.597  0.260  0.063 |}
\NormalTok{## 5            |  2.476 | -2.390  1.305  0.932 |  0.647  0.305  0.068 |}
\NormalTok{## 6            |  2.555 | -2.076  0.984  0.660 |  1.489  1.617  0.340 |}
\NormalTok{## 7            |  2.468 | -2.444  1.364  0.981 |  0.048  0.002  0.000 |}
\NormalTok{## 8            |  2.246 | -2.233  1.139  0.988 |  0.223  0.036  0.010 |}
\NormalTok{## 9            |  2.592 | -2.335  1.245  0.812 | -1.115  0.907  0.185 |}
\NormalTok{## 10           |  2.249 | -2.184  1.090  0.943 | -0.469  0.160  0.043 |}
\NormalTok{##               Dim.3    ctr   cos2  }
\NormalTok{## 1            -0.128  0.074  0.003 |}
\NormalTok{## 2            -0.235  0.250  0.011 |}
\NormalTok{## 3             0.044  0.009  0.000 |}
\NormalTok{## 4             0.091  0.038  0.001 |}
\NormalTok{## 5             0.016  0.001  0.000 |}
\NormalTok{## 6             0.027  0.003  0.000 |}
\NormalTok{## 7             0.335  0.511  0.018 |}
\NormalTok{## 8            -0.089  0.036  0.002 |}
\NormalTok{## 9             0.145  0.096  0.003 |}
\NormalTok{## 10           -0.254  0.293  0.013 |}
\NormalTok{## }
\NormalTok{## Variables}
\NormalTok{##                 Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr}
\NormalTok{## Sepal.Length |  0.890 27.151  0.792 |  0.361 14.244  0.130 | -0.276 51.778}
\NormalTok{## Sepal.Width  | -0.460  7.255  0.212 |  0.883 85.247  0.779 |  0.094  5.972}
\NormalTok{## Petal.Length |  0.992 33.688  0.983 |  0.023  0.060  0.001 |  0.054  2.020}
\NormalTok{## Petal.Width  |  0.965 31.906  0.931 |  0.064  0.448  0.004 |  0.243 40.230}
\NormalTok{##                cos2  }
\NormalTok{## Sepal.Length  0.076 |}
\NormalTok{## Sepal.Width   0.009 |}
\NormalTok{## Petal.Length  0.003 |}
\NormalTok{## Petal.Width   0.059 |}
\KeywordTok{dimdesc}\NormalTok{ (acp.iris)}
\NormalTok{## $Dim.1}
\NormalTok{## $Dim.1$quanti}
\NormalTok{##              correlation       p.value}
\NormalTok{## Petal.Length   0.9915552 3.369916e-133}
\NormalTok{## Petal.Width    0.9649790  6.609632e-88}
\NormalTok{## Sepal.Length   0.8901688  2.190813e-52}
\NormalTok{## Sepal.Width   -0.4601427  3.139724e-09}
\NormalTok{## }
\NormalTok{## }
\NormalTok{## $Dim.2}
\NormalTok{## $Dim.2$quanti}
\NormalTok{##              correlation      p.value}
\NormalTok{## Sepal.Width    0.8827163 2.123801e-50}
\NormalTok{## Sepal.Length   0.3608299 5.731933e-06}
\NormalTok{## }
\NormalTok{## }
\NormalTok{## $Dim.3}
\NormalTok{## $Dim.3$quanti}
\NormalTok{##              correlation      p.value}
\NormalTok{## Petal.Width    0.2429827 0.0027349555}
\NormalTok{## Sepal.Length  -0.2756577 0.0006395628}
\NormalTok{acp.iris <-}\StringTok{ }\KeywordTok{PCA}\NormalTok{(iris, }\DataTypeTok{quali.sup =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{lafc}{%
\chapter{L'AFC}\label{lafc}}

\hypertarget{principe-de-lafc}{%
\section{Principe de l'AFC}\label{principe-de-lafc}}

L'AFC sert à analyser le lien entre deux variables qualitatives. On l'utilise quand le nombre de modalités des variables est tel que la lecture du tableau de contingence (comptage des effectifs d'individus dans les cases du tableau croisé) devient complexe, voire impossible.

S'il y a indépendance etre les deux variables qualitatives, réaliser l'AFC n'a guère de sens \(\Rightarrow\) commencer par un test du \(\chi^2\).

On considère ici des variables qualitatives ``pures'' ou nominales. Si l'on utilise une variable ordinale (exemple : avec les modalités `petit', `moyen' et `grand' codées 1, 2 et 3), l'ordre des modalités est perdu.

Lors de la construction du tableau de contingence, pour chacune des variables, les modalités sont exclusives : chacun des individus possède une modalité et une seule pour chacune des deux variables. Les modalités avec des effectifs nuls sont écartées.

Exemple d'une enquête réalisée au niveau national, dans laquelle on pose des questions avec quatre modalités possibles de réponses.

\includegraphics{images/tableau_contingence.png}

L'AFC permet simultanément de :

\begin{itemize}
\tightlist
\item
  Comparer les profils-lignes entre eux (les distributions de réponses entre les différentes régions).\\
\item
  Comparer les profils-colonnes entre eux (les distributions de régions parmi les réponses).\\
\item
  Repérer les cases du tableau de contingence où les effectifs observés \(n_{i,j}\) sont nettement différents des effectifs théoriques (effectifs sous l'hypothèse d'indépendance) pour mettre en évidence les modalités \(i\) de \(X\) et \(j\) de \(Y\) qui tendent à être présentes simultanément (\(f_{i,j} > p_{i,j}\)) et celles qui tendent à s'exclure mutuellement (\(f_{i,j} < p_{i,j}\)).
\end{itemize}

Remarque : statistique du \(\chi^2\) \(\Rightarrow\) module 3 ``Statistiques descriptives''.

L'AFC consiste donc à synthétiser un tableau de contingence trop grand. Au plan mathématique, elle revient à faire une ACP du tableau de contingence avec la métrique du \(\chi^2\).

Dans le tableau de contingence, on continue à désigner les colonnes sous le nom de \emph{variables} et les lignes sous le nom d'\emph{individus}, afin de conserver un parallélisme dans les présentations de l'AFC et de l'ACP. Cependant, il faut garder en tête que les lignes, comme les colonnes, représentent les modalités des deux variables qui sont analysées, et qu'on désignera par la suite par \emph{caractères}.

L'inertie totale du tableau de contingence vaut \(\frac{\chi^2}{n}\), et, contrairement au cas de l'ACP, on peut représenter les \emph{individus} et les \emph{variables} sur le même graphique car l'espace des \emph{individus} et l'espace des \emph{variables} sont les mêmes.

\(\Rightarrow\) En \textbf{ACP}, on cherche à conserver au mieux la \textbf{variance} de la population ; en \textbf{AFC}, l'\textbf{écart à l'indépendance}.

Pour que chacune des modalités des deux \emph{caractères} soit correctement représentée dans l'analyse, il faut avoir des effectifs suffisants dans les cases du tableau de contingence. Cela peut signifier la nécessité d'exclure certaines modalités trop rares, ou de regrouper des modalités pour en augmenter les effectifs.

Pour une explication en vidéo par l'auteur du package FactoMiner, \href{https://www.youtube.com/watch?v=f_lgjXVdTAk}{cliquer ici}.
Pour un cours en pdf, rendez-vous sur \href{http://factominer.free.fr/docs/cours_afc.pdf}{cette page}.

\hypertarget{lafc-avec-factominer}{%
\section{L'AFC avec FactoMiner}\label{lafc-avec-factominer}}

Un exemple est donné, dans lequel on veut savoir s'il existe un lien entre les caractéristiques des voitures immatriculées et l'endroit où elles le sont (le département).

\hypertarget{donnees-utilisees-1}{%
\subsection{Données utilisées}\label{donnees-utilisees-1}}

Il s'agit des \href{http://www.statistiques.developpement-durable.gouv.fr/fileadmin/documents/Themes/Transports/Vehicules_routiers/Immatriculations/resultats_detailles/2015/immatriculations-2015-2ir2.xls}{immatriculations des voitures particulières d'occasion par département, région et carrosserie}.

Le fichier de départ a été converti au format \emph{.csv}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{immat <-}\StringTok{ }\KeywordTok{read.csv2}\NormalTok{ (}\DataTypeTok{file =} \StringTok{'data/AFC_immat.csv'}\NormalTok{, }\DataTypeTok{dec=}\StringTok{','}\NormalTok{,}
                    \DataTypeTok{header =}\NormalTok{ T, }\DataTypeTok{encoding =} \StringTok{"latin1"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{rename}\NormalTok{ (}\DataTypeTok{dep =} \StringTok{`}\DataTypeTok{Départements}\StringTok{`}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{filter}\NormalTok{ (dep }\OperatorTok{!=}\StringTok{ "Total"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{ (}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\OperatorTok{-}\NormalTok{Total) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate_if}\NormalTok{ (is.numeric, }\KeywordTok{funs}\NormalTok{ (}\KeywordTok{replace}\NormalTok{ (., }\KeywordTok{is.na}\NormalTok{(.), }\DecValTok{0}\NormalTok{))) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{column_to_rownames}\NormalTok{ (}\DataTypeTok{var =} \StringTok{"dep"}\NormalTok{)}

\KeywordTok{head}\NormalTok{ (immat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Break Cabriolet Conduite.intérieure
## Bas-Rhin       19668      2184               74109
## Haut-Rhin      14937      1676               56014
## Dordogne        8171       944               33144
## Gironde        28384      4221              117207
## Landes          8762       878               32774
## Lot-et-Garonne  6185       761               27195
##                Véhicule.pour.handicapés Autres
## Bas-Rhin                             14     54
## Haut-Rhin                             6     48
## Dordogne                              8     42
## Gironde                              22    142
## Landes                                5     56
## Lot-et-Garonne                       11     36
\end{verbatim}

\textbf{Attention : }notez que dans cet exemple, la base de données est déjà sous forme de tableau de contingence : les lignes correspondent aux modalités du \emph{caractère} ``département'' et les colonnes aux modalités \emph{du caractère} ``type de voiture''.

Si l'on partait d'un classique tableau individus (en lignes) / variables (en colonnes), il faudra construire au préalable le tableau de contingence à l'aide de la fonction \texttt{table} (cf.~module 2).

\hypertarget{realisation-de-lafc}{%
\subsection{Réalisation de l'AFC}\label{realisation-de-lafc}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{afc <-}\StringTok{ }\KeywordTok{CA}\NormalTok{ (immat, }\DataTypeTok{graph =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{names}\NormalTok{ (afc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "eig"  "call" "row"  "col"  "svd"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{ (afc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## CA(X = immat, graph = FALSE) 
## 
## The chi square of independence between the two variables is equal to 22332.55 (p-value =  0 ).
## 
## Eigenvalues
##                        Dim.1   Dim.2   Dim.3   Dim.4
## Variance               0.001   0.001   0.000   0.000
## % of var.             56.219  37.398   5.549   0.834
## Cumulative % of var.  56.219  93.617  99.166 100.000
## 
## Rows (the 10 first)
##                            Iner*1000    Dim.1    ctr   cos2    Dim.2
## Bas-Rhin                 |     0.027 |  0.052  2.083  0.894 |  0.008
## Haut-Rhin                |     0.022 |  0.054  1.708  0.897 |  0.011
## Dordogne                 |     0.003 |  0.026  0.221  0.947 |  0.003
## Gironde                  |     0.025 |  0.012  0.180  0.084 |  0.041
## Landes                   |     0.015 |  0.062  1.287  0.955 | -0.002
## Lot-et-Garonne           |     0.001 | -0.005  0.006  0.072 | -0.002
## Pyrénées-Atlantiques     |     0.025 |  0.066  2.141  0.984 | -0.007
## Allier                   |     0.002 | -0.004  0.005  0.024 | -0.027
## Cantal                   |     0.029 |  0.103  1.119  0.438 | -0.053
## Haute-Loire              |     0.026 |  0.082  1.145  0.500 | -0.040
##                             ctr   cos2    Dim.3    ctr   cos2  
## Bas-Rhin                  0.082  0.023 | -0.015  1.772  0.075 |
## Haut-Rhin                 0.109  0.038 | -0.011  0.768  0.040 |
## Dordogne                  0.004  0.012 |  0.005  0.088  0.037 |
## Gironde                   2.946  0.911 |  0.002  0.066  0.003 |
## Landes                    0.002  0.001 |  0.013  0.557  0.041 |
## Lot-et-Garonne            0.001  0.008 |  0.011  0.343  0.399 |
## Pyrénées-Atlantiques      0.034  0.010 |  0.004  0.094  0.004 |
## Allier                    0.261  0.873 |  0.001  0.003  0.001 |
## Cantal                    0.434  0.113 |  0.105 11.599  0.448 |
## Haute-Loire               0.406  0.118 |  0.071  8.864  0.382 |
## 
## Columns
##                            Iner*1000    Dim.1    ctr   cos2    Dim.2
## Break                    |     0.903 |  0.070 78.767  0.994 |  0.004
## Cabriolet                |     0.746 | -0.034  2.293  0.035 |  0.179
## Conduite.intérieure      |     0.218 | -0.015 16.524  0.864 | -0.006
## Véhicule.pour.handicapés |     0.019 |  0.023  0.008  0.005 |  0.002
## Autres                   |     0.141 |  0.193  2.408  0.194 |  0.094
##                             ctr   cos2    Dim.3    ctr   cos2  
## Break                     0.362  0.003 | -0.004  2.386  0.003 |
## Cabriolet                94.927  0.964 | -0.005  0.515  0.001 |
## Conduite.intérieure       3.842  0.134 |  0.001  0.344  0.002 |
## Véhicule.pour.handicapés  0.000  0.000 | -0.106  1.732  0.105 |
## Autres                    0.868  0.047 |  0.381 95.022  0.757 |
\end{verbatim}

La structure de l'objet est très comparable à l'objet ACP.

\hypertarget{nombre-daxes-a-retenir-1}{%
\subsection{Nombre d'axes à retenir}\label{nombre-daxes-a-retenir-1}}

Le choix du nombre d'axes se fait exactement comme pour l'ACP. Ici on en retiendrait\ldots{} Combien ? (dur\ldots{})

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eig <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{ (afc}\OperatorTok{$}\NormalTok{eig)}
\NormalTok{mm <-}\StringTok{ }\KeywordTok{mean}\NormalTok{ (eig}\OperatorTok{$}\StringTok{`}\DataTypeTok{percentage of variance}\StringTok{`}\NormalTok{)}
\KeywordTok{ggplot}\NormalTok{ (eig, }\KeywordTok{aes}\NormalTok{ (}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(eig), }\DataTypeTok{weight =} \StringTok{`}\DataTypeTok{percentage of variance}\StringTok{`}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{ (}\DataTypeTok{fill =} \StringTok{"lightblue"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{ () }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{ (}\StringTok{"Eboulis des valeurs propres"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{theme}\NormalTok{ (}\DataTypeTok{axis.title =} \KeywordTok{element_blank}\NormalTok{ ())}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_hline}\NormalTok{ (}\DataTypeTok{yintercept =}\NormalTok{ mm)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/afc_3-1.pdf}

\hypertarget{interpretation-des-axes}{%
\subsection{Interprétation des axes}\label{interpretation-des-axes}}

Pour l'interprétation des positions des \emph{individus} et des \emph{variables} (dans le même espace), on retiendra :

\begin{itemize}
\tightlist
\item
  les \emph{variables} et \emph{individus} interprétables sont ceux qui sont éloignés su centre du nuage de points.
\item
  La proximité de deux modalités (bien projetées) d'une même variable indique que les individus (au sens du tableau de départ) qui prennent ces modalités ont des profils similaires sur le reste des autres variables.
\item
  La proximité de deux modalités de variables différentes tend à indiquer que ce sont (à peu près) les mêmes individus qui prennent ces modalités, mais ce n'est pas toujours le cas.
\end{itemize}

Si une modalité soit graphiquement très éloignée des autres, c'est qu'elle possède dans le tableau de départ un profil tout à fait spécifique. Sa position dans le plan factoriel étant isolée, elle empêche une étude précise des positions des autres points qui se retrouvent « en paquet ». Il est recommandé dans ce cas de rendre cette modalité inactive (on la met en individu et variable supplémentaire), ce qui revient à réaliser l'AFC du tableau de départ en éliminant la ligne ou la colonne représentant cette modalité.

Remarque : La position moyenne des modalités de chacun des \emph{caractères} est au centre du plan factoriel, quel que soit le couple d'axes représenté (ex : \(F_1, F_2\)).

On peut s'aider des graphiques avec sélection des profils lignes/colonne selon leur contribution et qualité de représentation.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.CA}\NormalTok{ (afc, }\DataTypeTok{selectRow =} \StringTok{"contrib 10"}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/afc_4-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.CA}\NormalTok{ (afc, }\DataTypeTok{selectRow =} \StringTok{"cos2 10"}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/afc_4-2.pdf}

Et approfondir avec \texttt{dimdesc} et le contenu des éléments de l'objet résultat :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a <-}\StringTok{ }\KeywordTok{dimdesc}\NormalTok{ (afc, }\DataTypeTok{axes =} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{)}
\NormalTok{a}\OperatorTok{$}\StringTok{`}\DataTypeTok{Dim 1}\StringTok{`}\OperatorTok{$}\NormalTok{col}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                                coord
## Cabriolet                -0.03406597
## Conduite.intérieure      -0.01541153
## Véhicule.pour.handicapés  0.02294535
## Break                     0.06990982
## Autres                    0.19286587
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a}\OperatorTok{$}\StringTok{`}\DataTypeTok{Dim 2}\StringTok{`}\OperatorTok{$}\NormalTok{col}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                                 coord
## Conduite.intérieure      -0.006061409
## Véhicule.pour.handicapés  0.001527471
## Break                     0.003865634
## Autres                    0.094473008
## Cabriolet                 0.178757047
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{ (a)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $`Dim 1`
## $`Dim 1`$row
##                                 coord
## Seine-Saint-Denis       -1.205028e-01
## Val-d'Oise              -8.791869e-02
## Val-de-Marne            -7.432990e-02
## Essonne                 -7.226047e-02
## Seine-et-Marne          -5.477814e-02
## Nord                    -5.037039e-02
## Seine-Maritime          -4.377076e-02
## Alpes-Maritimes         -4.250122e-02
## Pas-de-Calais           -4.224495e-02
## Bouches-du-Rhône        -3.837182e-02
## Pyrénées-Orientales     -3.374121e-02
## Yvelines                -3.344429e-02
## Aisne                   -3.149320e-02
## Aube                    -3.143509e-02
## Eure-et-Loir            -3.128713e-02
## Eure                    -2.676634e-02
## Loiret                  -2.590359e-02
## Ardennes                -2.143561e-02
## Gard                    -2.139036e-02
## Vaucluse                -2.035721e-02
## Loire                   -1.913524e-02
## Meurthe-et-Moselle      -1.910311e-02
## Orne                    -1.836443e-02
## Hérault                 -1.761927e-02
## Oise                    -1.571449e-02
## Var                     -1.529432e-02
## Sarthe                  -1.379318e-02
## Rhône                   -1.261760e-02
## Tarn-et-Garonne         -1.201273e-02
## Indre-et-Loire          -1.059448e-02
## Territoire de Belfort   -7.278324e-03
## Lot-et-Garonne          -4.724635e-03
## Allier                  -4.394207e-03
## Haute-Marne             -3.502886e-03
## Loir-et-Cher            -3.140012e-03
## Yonne                   -2.568009e-03
## Somme                   -2.507620e-03
## Cher                    -2.331563e-03
## Vienne                  -1.466094e-03
## Haute-Garonne           -5.090963e-05
##                         -3.012981e-31
## Puy-de-Dôme              1.540346e-03
## Drôme                    1.877008e-03
## Haute-Vienne             3.743229e-03
## Marne                    3.815582e-03
## Nièvre                   5.565141e-03
## Isère                    6.018624e-03
## Moselle                  6.172150e-03
## Hauts-de-Seine           6.554576e-03
## Meuse                    7.385971e-03
## Calvados                 8.469428e-03
## Maine-et-Loire           1.144199e-02
## Vosges                   1.197765e-02
## Gironde                  1.226144e-02
## Indre                    1.231941e-02
## Charente                 1.256245e-02
## Aude                     1.339194e-02
## Saône-et-Loire           1.489107e-02
## Mayenne                  1.558344e-02
## Ardèche                  1.559999e-02
## Haute-Saône              1.777123e-02
## Loire-Atlantique         1.805983e-02
## Tarn                     1.922924e-02
## Dordogne                 2.559593e-02
## Charente-Maritime        2.593709e-02
## Corrèze                  3.210698e-02
## Côte-d'Or                3.809917e-02
## Gers                     4.148141e-02
## Creuse                   4.343192e-02
## Deux-Sèvres              4.501198e-02
## Ain                      4.622389e-02
## Ille-et-Vilaine          4.712467e-02
## Hautes-Pyrénées          4.859568e-02
## Ariège                   4.994071e-02
## Lot                      5.043305e-02
## Alpes-de-Haute-Provence  5.053949e-02
## Doubs                    5.105133e-02
## Paris                    5.137144e-02
## Corse-du-Sud             5.192945e-02
## Bas-Rhin                 5.218902e-02
## Vendée                   5.295559e-02
## Aveyron                  5.356964e-02
## Côtes-d'Armor            5.390284e-02
## Haut-Rhin                5.432006e-02
## Manche                   5.969410e-02
## Haute-Corse              6.131374e-02
## Landes                   6.168946e-02
## Pyrénées-Atlantiques     6.557587e-02
## Jura                     6.747017e-02
## Morbihan                 7.773702e-02
## Haute-Loire              8.176348e-02
## Finistère                8.693922e-02
## Cantal                   1.034789e-01
## Savoie                   1.231039e-01
## Haute-Savoie             1.430532e-01
## Lozère                   1.445917e-01
## Hautes-Alpes             1.740661e-01
## 
## $`Dim 1`$col
##                                coord
## Cabriolet                -0.03406597
## Conduite.intérieure      -0.01541153
## Véhicule.pour.handicapés  0.02294535
## Break                     0.06990982
## Autres                    0.19286587
## 
## 
## $`Dim 2`
## $`Dim 2`$row
##                                 coord
## Seine-Saint-Denis       -6.804845e-02
## Lozère                  -6.282311e-02
## Mayenne                 -5.786252e-02
## Cantal                  -5.258330e-02
## Finistère               -4.971712e-02
## Côtes-d'Armor           -4.484982e-02
## Creuse                  -4.314707e-02
## Maine-et-Loire          -4.273399e-02
## Haute-Loire             -3.968751e-02
## Ariège                  -3.734793e-02
## Territoire de Belfort   -3.666758e-02
## Haute-Saône             -3.610000e-02
## Hautes-Pyrénées         -3.605016e-02
## Nièvre                  -3.527796e-02
## Orne                    -3.492388e-02
## Doubs                   -3.457935e-02
## Jura                    -3.357340e-02
## Haute-Vienne            -3.048780e-02
## Aveyron                 -3.037677e-02
## Vosges                  -2.983557e-02
## Isère                   -2.972866e-02
## Aisne                   -2.949380e-02
## Allier                  -2.653724e-02
## Eure-et-Loir            -2.574538e-02
## Val-de-Marne            -2.534338e-02
## Loire                   -2.504104e-02
## Yonne                   -2.473389e-02
## Somme                   -2.456922e-02
## Côte-d'Or               -2.454563e-02
## Val-d'Oise              -2.391910e-02
## Sarthe                  -2.357502e-02
## Cher                    -2.332247e-02
## Manche                  -2.164958e-02
## Ille-et-Vilaine         -2.161899e-02
## Vendée                  -2.137873e-02
## Saône-et-Loire          -2.135809e-02
## Morbihan                -2.133030e-02
## Ardennes                -2.105406e-02
## Deux-Sèvres             -2.101219e-02
## Puy-de-Dôme             -2.096500e-02
## Loir-et-Cher            -2.074057e-02
## Essonne                 -2.066025e-02
## Savoie                  -1.928556e-02
## Indre                   -1.891997e-02
## Oise                    -1.882057e-02
## Meuse                   -1.701860e-02
## Hautes-Alpes            -1.698177e-02
## Rhône                   -1.587399e-02
## Tarn                    -1.528299e-02
## Aube                    -1.471184e-02
## Loire-Atlantique        -1.400754e-02
## Corrèze                 -1.174709e-02
## Loiret                  -1.165232e-02
## Vienne                  -1.004011e-02
## Gers                    -9.023304e-03
## Haute-Marne             -8.455006e-03
## Pyrénées-Atlantiques    -6.728537e-03
## Pas-de-Calais           -6.445579e-03
## Tarn-et-Garonne         -6.081220e-03
## Seine-et-Marne          -5.903842e-03
## Nord                    -5.865414e-03
## Ardèche                 -3.944466e-03
## Ain                     -3.083734e-03
## Landes                  -2.171074e-03
## Marne                   -1.585396e-03
## Lot-et-Garonne          -1.571293e-03
## Meurthe-et-Moselle      -4.923831e-04
##                          2.826051e-30
## Indre-et-Loire           1.866924e-03
## Dordogne                 2.930141e-03
## Calvados                 4.672278e-03
## Drôme                    5.589878e-03
## Seine-Maritime           6.868601e-03
## Alpes-de-Haute-Provence  6.926638e-03
## Haute-Garonne            7.267337e-03
## Lot                      7.784406e-03
## Bas-Rhin                 8.453751e-03
## Gard                     1.060292e-02
## Haut-Rhin                1.117205e-02
## Aude                     1.327454e-02
## Haute-Corse              1.699308e-02
## Bouches-du-Rhône         2.001680e-02
## Yvelines                 2.046225e-02
## Moselle                  2.055545e-02
## Charente                 2.726250e-02
## Eure                     2.982343e-02
## Hérault                  3.131496e-02
## Charente-Maritime        3.324311e-02
## Haute-Savoie             3.426670e-02
## Vaucluse                 3.743514e-02
## Hauts-de-Seine           3.804606e-02
## Gironde                  4.050476e-02
## Pyrénées-Orientales      4.436732e-02
## Corse-du-Sud             7.222577e-02
## Var                      1.105449e-01
## Paris                    1.424313e-01
## Alpes-Maritimes          1.577608e-01
## 
## $`Dim 2`$col
##                                 coord
## Conduite.intérieure      -0.006061409
## Véhicule.pour.handicapés  0.001527471
## Break                     0.003865634
## Autres                    0.094473008
## Cabriolet                 0.178757047
\end{verbatim}

\textbf{Interprétation de l'exemple} :

\begin{itemize}
\tightlist
\item
  Les modalités fortement contributives à la formation des deux premiers axes ont presque toutes une bonne qualité de représentation (ce n'est pas toujours le cas).
\item
  Concernant les modalités du ``type de voiture'', on remarque une distinction nette entre les cabriolets d'un côté, et les ``autres'' d'un\ldots{} autre côté.
\item
  Concernant les modalités ``département'', on remarque une opposition entre les départements du nord et de l'Île de France (quart sud-ouest), les Alpes Maritimes et le Var (quart nord ouest), mais également la Savoie et la Haute-Savoie (Est).
\item
  Concernant le croisement des deux modalités, il apparaît immédiatement une proximité entre le type cabriolet et les départements du pourtour méditerranéen, les ``autres'' (sans doute type SUV ou 4x4) avec les départements de montagne. Paris est également très atypique, le département le plus éloigné des types ``standard''. On peut également dire que les départements du nord parisien ont une sur-repréentation marquée des conduites intérieures (ce qui revient à dire qu'ils comptent peu des autres types).
\item
  Les types conduite intérieure, break et véhicules pour handicapés sont proches du barycentre du nuage, ce qui en fait un type ``standard'', sans appartenance géographique particulière.
\end{itemize}

\hypertarget{exercice-1}{%
\section{Exercice}\label{exercice-1}}

Refaire pas à pas \href{http://www.sthda.com/french/articles/38-methodes-des-composantes-principales-dans-r-guide-pratique/74-afc-analyse-factorielle-des-correspondances-avec-r-l-essentiel/}{cet exercice}

\hypertarget{lacm}{%
\chapter{L'ACM}\label{lacm}}

\hypertarget{principe-de-lacm}{%
\section{Principe de l'ACM}\label{principe-de-lacm}}

L'ACM permet d'analyser les liens entre \(p\) variables \textbf{qualitatives}. C'est une généralisation de l'AFC pour \(p > 2\) variables qualitatives.

On peut y mettre des variable quantitatives, à condition de les discrétiser (donc de les transformer en variables qualitatives).

L'ACM est une AFC faite sur le tableau disjonctif complet (ou le tableau de Burt, non traité ici). Le poids de chacune des variables est donc le nombre de ses modalités moins 1. Cela signifie qu'une variable avec un grand nombre de modalités pèsera plus dans la constitution des axes qu'une autre avec peu de modalités. À l'inverse, le poids des individus (lignes) peut être spécifié dans FactoMiner (argument \texttt{row.w} de la fonction \texttt{MCA}).

Le résultat d'une ACM, comme pour les autres analyses factorielles, est consitué des coordonnées des individus et des variables dans le nouvel espace construit. On peut donc utiliser cette technique pour \textbf{transformer des variables qualitatives en variables continues}.

\hypertarget{le-tableau-disjonctif-complet}{%
\subsection{Le tableau disjonctif complet}\label{le-tableau-disjonctif-complet}}

On (enfin, R le fait tout seul) transforme les modalités des variables qualitatives en autant de variables binaires.

\textbf{Table ordonnée}

\includegraphics{exploration_avancee_files/figure-latex/acm_1-1.pdf}

\textbf{Tableau disjonctif complet}

\includegraphics{exploration_avancee_files/figure-latex/acm_2-1.pdf}

La ``dernière'' des colonnes correspondant à une variable peut être déduite des valeurs observées dans les autres. Par exemple si Sexe\_H=1, alors Sexe\_F=0 et vice versa.

\hypertarget{ressources-1}{%
\section{Ressources}\label{ressources-1}}

Un cours assez détaillé sur l'ACM sur \href{https://www.math.u-bordeaux.fr/~machaven/wordpress/wp-content/uploads/2013/10/ACM.pdf}{ce fichier pdf}, et sur l'ACM avec Factominer sur \href{http://factominer.free.fr/factomethods/analyse-des-correspondances-multiples.html}{cette page}.

\hypertarget{lacm-avec-factominer}{%
\section{L'ACM avec FactoMiner}\label{lacm-avec-factominer}}

\hypertarget{exemple-1}{%
\subsection{Exemple}\label{exemple-1}}

\hypertarget{donnees-utilisees-2}{%
\subsubsection{Données utilisées}\label{donnees-utilisees-2}}

Le jeu de donnée est pris directement dans le package \texttt{FactoMineR} : il s'agit d'un \emph{dataframe} rassemblant des données concernant les hobbies des personnes interrogées. Pour l'analyse, on ne retient que les variables concernant ces pratiques, en mettant de côté les variables décrivant les individus eux-mêmes, soit les variables 19 à 23 du \emph{dataframe.}

Chargement des données :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{ (hobbies)}
\end{Highlighting}
\end{Shaded}

Examen rapide :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{ (hobbies)}
\end{Highlighting}
\end{Shaded}

\hypertarget{realisation-de-lacm}{%
\subsection{Réalisation de l'ACM}\label{realisation-de-lacm}}

Analyse et création de l'objet :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acm <-}\StringTok{ }\KeywordTok{select}\NormalTok{ (hobbies, }\OperatorTok{-}\NormalTok{(}\DecValTok{19}\OperatorTok{:}\DecValTok{23}\NormalTok{)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{MCA}\NormalTok{ (}\DataTypeTok{graph =}\NormalTok{ F)}
\KeywordTok{names}\NormalTok{ (acm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "eig"  "call" "ind"  "var"  "svd"
\end{verbatim}

Si l'on veut en savoir plus :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{ (acm)}
\end{Highlighting}
\end{Shaded}

\hypertarget{nombre-daxes-retenus}{%
\subsubsection{Nombre d'axes retenus}\label{nombre-daxes-retenus}}

On reprend les méthodes vues pour l'ACP et l'AFC.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Valeurs propres et inertie moyenne}
\KeywordTok{head}\NormalTok{ (acm}\OperatorTok{$}\NormalTok{eig)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       eigenvalue percentage of variance cumulative percentage of variance
## dim 1 0.19771155              16.946704                          16.94670
## dim 2 0.08064911               6.912781                          23.85948
## dim 3 0.07202181               6.173298                          30.03278
## dim 4 0.06287244               5.389066                          35.42185
## dim 5 0.05846003               5.010860                          40.43271
## dim 6 0.05581245               4.783924                          45.21663
\end{verbatim}

La première dimension est au-dessus des autres.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eig <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{ (acm}\OperatorTok{$}\NormalTok{eig)}
\KeywordTok{mean}\NormalTok{ (eig}\OperatorTok{$}\StringTok{`}\DataTypeTok{percentage of variance}\StringTok{`}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4.761905
\end{verbatim}

Ici, le critère de l'inertie moyenne conduirait à retenir 5 voire 6 axes factoriels qui portent 40 à 45\% de l'hétérogénéité.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acm}\OperatorTok{$}\NormalTok{eig[,}\DecValTok{1}\NormalTok{] }\OperatorTok{%>%}\StringTok{ }\KeywordTok{diff}\NormalTok{() }\OperatorTok{%>%}\StringTok{ }\KeywordTok{diff}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         dim 3         dim 4         dim 5         dim 6         dim 7 
##  0.1084351542 -0.0005220826  0.0047369634  0.0017648268  0.0023585191 
##         dim 8         dim 9        dim 10        dim 11        dim 12 
## -0.0019260770  0.0019513049 -0.0036504504  0.0012774599  0.0012178535 
##        dim 13        dim 14        dim 15        dim 16        dim 17 
## -0.0001422951  0.0014088702 -0.0024082694 -0.0002577355  0.0021717212 
##        dim 18        dim 19        dim 20        dim 21 
## -0.0004689857 -0.0001353936 -0.0013750132  0.0003297842
\end{verbatim}

Le critère du coude est lui nettement plus parcimonieux et conduit à retenir 3 axes : la dérivée seconde change de signe entre les axes 3 et 4. Mais dans ce cas, seule 30\% de l'inertie est conservée.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mm <-}\StringTok{ }\KeywordTok{mean}\NormalTok{ (eig}\OperatorTok{$}\StringTok{`}\DataTypeTok{percentage of variance}\StringTok{`}\NormalTok{)}
\KeywordTok{ggplot}\NormalTok{ (eig, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(eig), }\DataTypeTok{weight =} \StringTok{`}\DataTypeTok{percentage of variance}\StringTok{`}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{ (}\DataTypeTok{fill =} \StringTok{"lightblue"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{ggtitle}\NormalTok{ (}\StringTok{"Eboulis des valeurs propres"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{theme}\NormalTok{ (}\DataTypeTok{axis.title =} \KeywordTok{element_blank}\NormalTok{()) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_hline}\NormalTok{ (}\DataTypeTok{yintercept =}\NormalTok{ mm)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_10-1.pdf}

Dans une ACM, on n'a pas forcément de ``décrochage'' évident dans l'éboulis des valeurs propres : il est plus difficile de concentrer l'inertie de variables qualitatives que quantitatives. On doit donc généralement retenir plus d'axes ou renoncer à une part significative de l'inertie.

En raison de cette dilution de l'information dans l'ACM, quand on dispose de variables qualitatives et quantitatives, il est souvent préférable de faire une ACP en introduisant les variable qualitatives en variables illustratives (si elles ne sont pas cruciales, évidemment).

On peut aussi retenir un nombre d'axes assez élevé, puis dans un second temps ne conserver que ceux qui sont bien interprétables.

\hypertarget{interpretation-des-axes-1}{%
\subsubsection{Interprétation des axes}\label{interpretation-des-axes-1}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{as.data.frame}\NormalTok{ (acm}\OperatorTok{$}\NormalTok{var}\OperatorTok{$}\NormalTok{eta2) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{datatable}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_11-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{ (acm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## MCA(X = ., graph = F) 
## 
## 
## Eigenvalues
##                        Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6
## Variance               0.198   0.081   0.072   0.063   0.058   0.056
## % of var.             16.947   6.913   6.173   5.389   5.011   4.784
## Cumulative % of var.  16.947  23.859  30.033  35.422  40.433  45.217
##                        Dim.7   Dim.8   Dim.9  Dim.10  Dim.11  Dim.12
## Variance               0.056   0.053   0.053   0.049   0.046   0.045
## % of var.              4.759   4.569   4.547   4.211   3.985   3.864
## Cumulative % of var.  49.976  54.545  59.092  63.303  67.288  71.152
##                       Dim.13  Dim.14  Dim.15  Dim.16  Dim.17  Dim.18
## Variance               0.044   0.043   0.041   0.038   0.037   0.036
## % of var.              3.730   3.717   3.497   3.256   3.200   3.105
## Cumulative % of var.  74.881  78.598  82.095  85.351  88.551  91.655
##                       Dim.19  Dim.20  Dim.21
## Variance               0.035   0.032   0.030
## % of var.              2.997   2.772   2.575
## Cumulative % of var.  94.652  97.425 100.000
## 
## Individuals (the 10 first)
##                      Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3
## 11000210          |  0.667  0.027  0.336 | -0.191  0.005  0.027 |  0.147
## 11000410          |  0.140  0.001  0.011 |  0.434  0.028  0.108 |  0.163
## 11000610          | -0.155  0.001  0.032 | -0.244  0.009  0.079 | -0.293
## 11000710          | -0.108  0.001  0.011 | -0.285  0.012  0.073 |  0.000
## 11000810          | -0.022  0.000  0.001 | -0.268  0.011  0.087 | -0.225
## 11000910          | -0.636  0.024  0.449 |  0.019  0.000  0.000 |  0.192
## 11001010          | -0.206  0.003  0.046 | -0.239  0.008  0.063 |  0.319
## 11001110          |  0.284  0.005  0.065 | -0.611  0.055  0.304 | -0.066
## 11001210          |  0.598  0.021  0.261 | -0.577  0.049  0.243 |  0.028
## 11001310          |  0.204  0.003  0.033 | -0.015  0.000  0.000 |  0.089
##                      ctr   cos2  
## 11000210           0.004  0.016 |
## 11000410           0.004  0.015 |
## 11000610           0.014  0.113 |
## 11000710           0.000  0.000 |
## 11000810           0.008  0.061 |
## 11000910           0.006  0.041 |
## 11001010           0.017  0.111 |
## 11001110           0.001  0.004 |
## 11001210           0.000  0.001 |
## 11001310           0.001  0.006 |
## 
## Categories (the 10 first)
##                       Dim.1     ctr    cos2  v.test     Dim.2     ctr
## Reading_0         |  -0.699   4.503   0.239 -44.766 |  -0.051   0.058
## Reading_1         |   0.341   2.199   0.239  44.766 |   0.025   0.028
## Listening music_0 |  -0.817   5.478   0.275 -48.111 |   0.241   1.170
## Listening music_1 |   0.337   2.262   0.275  48.111 |  -0.100   0.483
## Cinema_0          |  -0.509   4.369   0.389 -57.170 |   0.287   3.398
## Cinema_1          |   0.764   6.561   0.389  57.170 |  -0.430   5.103
## Show_0            |  -0.394   3.109   0.383 -56.753 |   0.109   0.586
## Show_1            |   0.972   7.663   0.383  56.753 |  -0.270   1.444
## Exhibition_0      |  -0.422   3.461   0.399 -57.885 |  -0.005   0.001
## Exhibition_1      |   0.945   7.745   0.399  57.885 |   0.012   0.003
##                      cos2  v.test     Dim.3     ctr    cos2  v.test  
## Reading_0           0.001  -3.255 |   0.460   5.367   0.104  29.496 |
## Reading_1           0.001   3.255 |  -0.225   2.621   0.104 -29.496 |
## Listening music_0   0.024  14.202 |   0.231   1.207   0.022  13.630 |
## Listening music_1   0.024 -14.202 |  -0.096   0.498   0.022 -13.630 |
## Cinema_0            0.123  32.200 |  -0.045   0.093   0.003  -5.030 |
## Cinema_1            0.123 -32.200 |   0.067   0.139   0.003   5.030 |
## Show_0              0.029  15.735 |   0.032   0.056   0.002   4.582 |
## Show_1              0.029 -15.735 |  -0.078   0.137   0.002  -4.582 |
## Exhibition_0        0.000  -0.748 |   0.076   0.306   0.013  10.384 |
## Exhibition_1        0.000   0.748 |  -0.169   0.684   0.013 -10.384 |
## 
## Categorical variables (eta2)
##                     Dim.1 Dim.2 Dim.3  
## Reading           | 0.239 0.001 0.104 |
## Listening music   | 0.275 0.024 0.022 |
## Cinema            | 0.389 0.123 0.003 |
## Show              | 0.383 0.029 0.002 |
## Exhibition        | 0.399 0.000 0.013 |
## Computer          | 0.327 0.058 0.041 |
## Sport             | 0.287 0.053 0.062 |
## Walking           | 0.172 0.107 0.002 |
## Travelling        | 0.355 0.000 0.000 |
## Playing music     | 0.209 0.005 0.002 |
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.MCA}\NormalTok{ (acm, }\DataTypeTok{axes =} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{, }\DataTypeTok{cex =} \FloatTok{0.7}\NormalTok{, }\DataTypeTok{invisible =} \StringTok{"ind"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.MCA}\NormalTok{ (acm, }\DataTypeTok{axes =} \DecValTok{3}\OperatorTok{:}\DecValTok{4}\NormalTok{, }\DataTypeTok{cex =} \FloatTok{0.7}\NormalTok{, }\DataTypeTok{invisible =} \StringTok{"ind"}\NormalTok{, }\DataTypeTok{selectMod =} \StringTok{"cos2 15"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_12-2.pdf}

Les résultats sur le premier plan factoriel sont assez parlants : le premier axe sépare les modalités ``pratique'' versus ``non pratique'' de l'acitivité. Le second axe semble opposer les activités manuelles ou physiques (coordonnées positives sur l'axe 2) aux activités plus culturelles (cinéma, musique\ldots{}).

Sur le deuxième plan factoriel, l'axe 3 permet de distinguer les individus qui pêchent et écoutent de la musique des individus qui font de la couture et de la cuisine. Le 4\^{}ème axe factoriel met en évidence les individus qui ne regardent pas la télévision et qui s'impliquent dans le volontariat.

\hypertarget{variables-supplementaires}{%
\subsection{Variables supplémentaires}\label{variables-supplementaires}}

Dans cet exemple, il est particulièrement judicieux d'utiliser les variables concernant les individus comme variables supplémentaires pour voir quel type de personne a quel type de hooby. On voit notamment que ce sont les moins qualifiés et les plus âgés qui ont moins de hobby, alors que les managers sont plutôt dans le cadrant des loisirs ``culturels''.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acm <-}\StringTok{ }\KeywordTok{MCA}\NormalTok{(hobbies,}\DataTypeTok{quali.sup =} \DecValTok{19}\OperatorTok{:}\DecValTok{22}\NormalTok{,}\DataTypeTok{quanti.sup =} \DecValTok{23}\NormalTok{,}\DataTypeTok{ncp=}\DecValTok{4}\NormalTok{,}\DataTypeTok{graph =}\NormalTok{ F)}
\KeywordTok{plot.MCA}\NormalTok{(acm,}\DataTypeTok{axes=}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{,}\DataTypeTok{cex=}\NormalTok{.}\DecValTok{7}\NormalTok{,}\DataTypeTok{selectMod =} \StringTok{"cos2 10"}\NormalTok{,}\DataTypeTok{select =} \StringTok{"contrib 10"}\NormalTok{, }\DataTypeTok{invisible =} \StringTok{"ind"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_13-1.pdf}

Les sorties de la fonction \texttt{summary} donnent en outre les coordonnées sur les axes factoriels des modalités des variables ainsi que sa qualité, sa contribution et le test de significativité associé (est-elle non nulle ?)
Elle donne également le rapport de corrélation (eta2, voir module 3 pour un rappel de ce qu'il signifie) entre le facteur et chacune de ces variables, ce qui permet d'apprécier l'intensité du lien entre la variable, toutes modalités confondues, et chaque facteur.

\hypertarget{exercice-2}{%
\section{Exercice}\label{exercice-2}}

A partir de ce qui vient d'être vu, complétez l'interprétation des résultats :

\begin{itemize}
\tightlist
\item
  Quelles sont les variables les plus contributrices aux 3 premiers axes ?
\item
  Quel est le hobby le plus courant ? Le plus discriminant ?
\item
  Affichez les individus dans les 2 premiers plans factoriels, en sélectionnant les 50 plus forts contributeurs à l'inertie.
\item
  Y a-t-il un lien entre hobbies et genre ?
\item
  Refaites l'ACM en ajoutant la variable sexe en variable active. Que constatez-vous ?
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.MCA}\NormalTok{ (acm, }\DataTypeTok{axes =} \DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{, }\DataTypeTok{invisible =} \StringTok{"var"}\NormalTok{, }\DataTypeTok{select =} \StringTok{"contrib 50"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_14-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot.MCA}\NormalTok{ (acm, }\DataTypeTok{axes =} \DecValTok{3}\OperatorTok{:}\DecValTok{4}\NormalTok{, }\DataTypeTok{invisible =} \StringTok{"var"}\NormalTok{, }\DataTypeTok{select =} \StringTok{"contrib 50"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_14-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acm2 <-}\StringTok{ }\KeywordTok{MCA}\NormalTok{ (hobbies, }\DataTypeTok{quali.sup =} \DecValTok{20}\OperatorTok{:}\DecValTok{22}\NormalTok{, }\DataTypeTok{quanti.sup =} \DecValTok{23}\NormalTok{, }\DataTypeTok{graph =}\NormalTok{ F)}
\KeywordTok{plot.MCA}\NormalTok{ (acm2, }\DataTypeTok{invisible =} \StringTok{"ind"}\NormalTok{, }\DataTypeTok{selectMod =} \StringTok{"contrib 20"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/acm_14-3.pdf}

\emph{Elément de réponse à la dernière question : rajouter la variable change complètement l'analyse et l'opposition H/F emporte une bonne partie de l'inertie} \(\Rightarrow\) \emph{il faut bien réfléchir à ce qu'on introduit comme variable dans l'analyse et la problématique à laquelle on veut répondre. Ici, on centre l'analyse sur les pratiques en termes de loisirs, donc introduire des variables sur les individus n'est pas pertinent}.

\hypertarget{classification-clustering}{%
\chapter{Classification (clustering)}\label{classification-clustering}}

Les méthodes de classification (= de partitionnement) servent à délimiter des groupes d'individus, ou typologies, à partir des caractéristiques de ces individus. En particulier, elles visent à distinguer des ensembles au sein desquels les individus se ressemblent plus qu'ils ne ressemblent aux individus des autres groupes.

Il faut être prudent dans leur interprétation : le fait que la méthode réussisse à délimiter des groupes ne démontre en rien la pertinence du découpage (c'est-à-dire l'existence de discontinuités entre des groupes plutôt homogènes). Ce n'est pas parce que vous avez découpé, avec un couteau, une tarte en 5 parts, que ce découpage reflète des discontinuités antérieures. Les méthodes de classifications sont, en quelques sortes, des couteaux \ldots{}

\hypertarget{les-k-moyennes}{%
\section{Les k-moyennes}\label{les-k-moyennes}}

\hypertarget{principe}{%
\subsection{Principe}\label{principe}}

L'algorithme des k-moyennes (ou nuées dynamiques, k-means en anglais) consiste à regrouper les individus dans k classes les plus homogènes possibles. Son fonctionnement est très intuitif et il est très peu coûteux en termes de calcul :

\begin{itemize}
\tightlist
\item
  l'utilisateur choisit le nombre de classes \(k\).
\item
  l'algorithme prend k points aléatoires (les centres) dans le nuage de point des individus.
\item
  chaque individu est affecté au centre le plus proche.
\item
  on calcule le barycentre des points de chaque classe consitutée \(\rightarrow\) les centres bougent.
\item
  on ré-affecte les individus au nouveau centre le plus proche
\item
  on répète les deux étapes précédentes jusqu'à ce que les barycentres ne ``bougent plus''
\end{itemize}

Cet algorithme fonctionne sur des variables \textbf{quantitatives} ; on peut le mobiliser sur les coordonnées factorielles des individus et donc l'appliquer sur des variables initialement qualitative (après avoir fait une ACM / AFC). En pratique, il converge assez rapidement et est donc très efficace, même sur de grands jeux de données.

\hypertarget{mise-en-oeuvre}{%
\subsection{Mise en oeuvre}\label{mise-en-oeuvre}}

Exemple sur les hobbies :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{coord <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{ (acm}\OperatorTok{$}\NormalTok{ind}\OperatorTok{$}\NormalTok{coord)}
\NormalTok{classif <-}\StringTok{ }\KeywordTok{kmeans}\NormalTok{ (coord, }\DataTypeTok{centers =} \DecValTok{4}\NormalTok{)}
\KeywordTok{str}\NormalTok{ (classif)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## List of 9
##  $ cluster     : Named int [1:8403] 4 1 3 3 3 2 3 3 4 3 ...
##   ..- attr(*, "names")= chr [1:8403] "11000210" "11000410" "11000610" "11000710" ...
##  $ centers     : num [1:4, 1:4] -0.05 -0.4649 0.0854 0.6346 0.323 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:4] "1" "2" "3" "4"
##   .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##  $ totss       : num 3473
##  $ withinss    : num [1:4] 508 473 312 429
##  $ tot.withinss: num 1722
##  $ betweenss   : num 1750
##  $ size        : int [1:4] 1998 2650 1914 1841
##  $ iter        : int 6
##  $ ifault      : int 0
##  - attr(*, "class")= chr "kmeans"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Taille des clusters}
\KeywordTok{table}\NormalTok{ (classif}\OperatorTok{$}\NormalTok{cluster)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##    1    2    3    4 
## 1998 2650 1914 1841
\end{verbatim}

Remarques :

\begin{itemize}
\tightlist
\item
  Le nombre de classes est choisi de façon arbitraire (comment savoir si ce nombre est correct ?).
\item
  Les résultats changent selon les points initiaux choisis \(\Rightarrow\) 2 exécutions consécutives donneront 2 résultats différents ! Deux solutions pour avoir tout le temps le même résultat :

  \begin{itemize}
  \tightlist
  \item
    fournir les centres initiaux à l'algorithme.
  \item
    fixer la ``graine'' du générateur de nombres aléatoires.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# initialisation des centres avec les quintiles (ça fait 4 points)}
\CommentTok{# Avec du R de base hyper efficace ^^ }
\NormalTok{init <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{ (coord, }\ControlFlowTok{function}\NormalTok{(x) }\KeywordTok{quantile}\NormalTok{ (x, }\KeywordTok{seq}\NormalTok{(.}\DecValTok{2}\NormalTok{,.}\DecValTok{8}\NormalTok{,.}\DecValTok{2}\NormalTok{)))}
\NormalTok{classif <-}\StringTok{ }\KeywordTok{kmeans}\NormalTok{ (coord, }\DataTypeTok{centers =}\NormalTok{ init)}
\CommentTok{# initialisation du générateur de nombres aléatoires}
\KeywordTok{set.seed}\NormalTok{ (}\DecValTok{1234}\NormalTok{)}
\NormalTok{classif <-}\StringTok{ }\KeywordTok{kmeans}\NormalTok{ (coord, }\DataTypeTok{centers =} \DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Pour récupérer les résultat dans son \emph{dataframe}, il suffit de rajouter le vecteur résultat dans le \emph{dataframe} initial :

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{names}\NormalTok{ (coord) <-}\StringTok{ }\KeywordTok{paste}\NormalTok{ (}\StringTok{"Axe"}\NormalTok{, }\DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{, }\DataTypeTok{sep =} \StringTok{""}\NormalTok{)}
\NormalTok{coord <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{ (coord, }\DataTypeTok{classe =} \KeywordTok{as.factor}\NormalTok{ (classif}\OperatorTok{$}\NormalTok{cluster))}
\KeywordTok{ggplot}\NormalTok{ (coord, }\KeywordTok{aes}\NormalTok{ (}\DataTypeTok{x =}\NormalTok{ Axe1, }\DataTypeTok{y =}\NormalTok{ Axe2, }\DataTypeTok{color =}\NormalTok{ classe)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/clust_3-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{ (coord, }\KeywordTok{aes}\NormalTok{ (}\DataTypeTok{x =}\NormalTok{ Axe3, }\DataTypeTok{y =}\NormalTok{ Axe4, }\DataTypeTok{color =}\NormalTok{ classe)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/clust_3-2.pdf}

Ici on remarque que les classes 2 et 3 s'opposent sur le premier plan factoriel : la classe 2 est plutôt du côté des personnes ayant peu de hobbies, à l'inverse de la classe 3 est composée d'individus ayant des occupations plutôt culturelles.
Les classes 1 et 4 sont opposées sur l'axe 3, ce qui signifie que la 1 regroupe des individus aux loisirs plutôt domestiques et la 4 des individus ayant des loisirs de plein air.

\hypertarget{quelques-conseils}{%
\subsection{Quelques conseils}\label{quelques-conseils}}

Pour décrire les classes, on peut, en plus de la représentation sur les axes factoriels, faire un tableau croisé de cette nouvelle variable avec les variables initiales qualitatives ou calculer des rapports de corrélations avec les variables initiales quantitatives.

Pour choisir le nombre de classes, on peut :

\begin{itemize}
\tightlist
\item
  tester plusieurs configuratons et choisir celle qui est la plus ``parlante'' (on est dans du descriptif, ne pas l'oublier !)
\item
  faire plusieurs classifications et choisir la meilleure au sens d'un indicateur du type \(\dfrac{1}{k} \dfrac{SS_{inter}}{SS_{total}}\)
\item
  repérer le nombre optimal avec une CAH
\end{itemize}

\hypertarget{la-classification-ascendante-hierarchique-cah}{%
\section{La classification ascendante hiérarchique (CAH)}\label{la-classification-ascendante-hierarchique-cah}}

Pourquoi cet acronyme ?

\begin{itemize}
\tightlist
\item
  Classification : on regroupe nos individus dans des classes
\item
  Ascendante : on part du niveau le plus fin (ie des individus)
\item
  Hiérarchique : la méthode aboutit à la construction d'un arbre
\end{itemize}

Comment faire : Regrouper les individus les plus proches deux à deux, puis les paquets d'individus deux à deux.

\begin{itemize}
\tightlist
\item
  Notion de distance pour déterminer les \emph{proximités}
\item
  Agrégation des individus puis des groupes d'individus : \emph{métrique} et \emph{hypermétrique}
\end{itemize}

\textbf{On cherche le nombre optimal de classes d'individus}, et pour parvenir à ce nombre, on peut jouer sur plusieurs paramètres :

\begin{itemize}
\tightlist
\item
  Choix des variables prises en compte : initiales ou composantes principales
\item
  Choix de la distance : euclidienne, \(\chi^2\), Mahalanobis\ldots{}
\item
  Choix de l'hypermétrique : Comment vont être regroupés les individus puis les groupes :

  \begin{itemize}
  \tightlist
  \item
    centres de gravité les plus proches
  \item
    saut minimum : on agrège les deux groupes pour lesquels la distance entre les deux individus les plus proches est la plus petite
  \item
    diamètre : on agrège les deux groupes pour lesquels la distance entre les deux individus les plus éloignés est la plus petite
  \end{itemize}
\end{itemize}

Plus de détails sur \href{http://maths.cnam.fr/IMG/pdf/Classification-2008-2.pdf}{cette page}

En général, on utilise le paramétrage suivant :

\begin{itemize}
\tightlist
\item
  Réaliser la classification à partir des composantes principales signifiantes (on prend en compte l'essentiel de l'inertie mais on laisse de côté un certain ``bruit'', qui correspond aux derniers axes factoriels)
\item
  Utiliser la distance euclidienne classique
\item
  Utiliser la méthode de Ward : à chaque étape, agréger les individus (groupes) font perdre le moins \emph{d'inertie inter-classes}
\end{itemize}

\(\Rightarrow\) la fonction \texttt{HCPC} du package factominer le fait directement pour vous.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hc <-}\StringTok{ }\KeywordTok{HCPC}\NormalTok{ (acm, }\DataTypeTok{nb.clust =} \DecValTok{5}\NormalTok{, }\DataTypeTok{graph=}\NormalTok{F)}
\KeywordTok{str}\NormalTok{(hc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## List of 5
##  $ data.clust:'data.frame':  8403 obs. of  24 variables:
##   ..$ Reading        : Factor w/ 2 levels "Reading_0","Reading_1": 2 2 2 2 2 1 1 2 2 2 ...
##   ..$ Listening music: Factor w/ 2 levels "Listening music_0",..: 2 1 2 1 2 1 2 2 2 2 ...
##   ..$ Cinema         : Factor w/ 2 levels "Cinema_0","Cinema_1": 2 1 1 1 2 1 1 2 2 2 ...
##   ..$ Show           : Factor w/ 2 levels "Show_0","Show_1": 2 1 1 1 2 1 1 2 2 1 ...
##   ..$ Exhibition     : Factor w/ 2 levels "Exhibition_0",..: 2 2 2 2 1 1 1 2 1 2 ...
##   ..$ Computer       : Factor w/ 2 levels "Computer_0","Computer_1": 1 1 1 1 1 1 2 2 2 1 ...
##   ..$ Sport          : Factor w/ 2 levels "Sport_0","Sport_1": 2 2 1 2 1 1 2 1 2 1 ...
##   ..$ Walking        : Factor w/ 2 levels "Walking_0","Walking_1": 2 2 1 1 2 1 1 1 2 1 ...
##   ..$ Travelling     : Factor w/ 2 levels "Travelling_0",..: 2 1 2 2 1 1 1 2 2 1 ...
##   ..$ Playing music  : Factor w/ 2 levels "Playing music_0",..: 1 1 1 1 1 1 1 1 2 2 ...
##   ..$ Collecting     : Factor w/ 2 levels "Collecting_0",..: 1 2 1 1 1 1 1 1 1 1 ...
##   ..$ Volunteering   : Factor w/ 2 levels "Volunteering_0",..: 2 2 1 1 1 1 1 1 1 1 ...
##   ..$ Mechanic       : Factor w/ 2 levels "Mechanic_0","Mechanic_1": 2 2 1 1 1 2 2 1 1 2 ...
##   ..$ Gardening      : Factor w/ 2 levels "Gardening_0",..: 1 2 1 1 1 1 1 1 1 2 ...
##   ..$ Knitting       : Factor w/ 2 levels "Knitting_0","Knitting_1": 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ Cooking        : Factor w/ 2 levels "Cooking_0","Cooking_1": 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ Fishing        : Factor w/ 2 levels "Fishing_0","Fishing_1": 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ TV             : Factor w/ 5 levels "TV_0","TV_1",..: 3 5 5 2 4 4 4 1 2 2 ...
##   ..$ Sex            : Factor w/ 2 levels "F","M": 1 2 1 2 2 2 2 2 1 1 ...
##   ..$ Age            : Factor w/ 8 levels "(25,35]","(35,45]",..: 4 3 1 6 4 3 2 8 2 1 ...
##   ..$ Marital status : Factor w/ 5 levels "Divorcee","Married",..: 2 2 3 2 2 2 2 4 4 4 ...
##   ..$ Profession     : Factor w/ 8 levels "Employee","Foreman",..: 3 6 3 6 1 4 1 6 3 1 ...
##   ..$ nb.activitees  : int [1:8403] 11 9 5 5 6 2 5 7 10 8 ...
##   ..$ clust          : Factor w/ 5 levels "1","2","3","4",..: 5 3 4 4 4 1 4 4 5 4 ...
##  $ desc.var  :List of 5
##   ..$ test.chi2 : num [1:22, 1:2] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:22] "Reading" "Listening.music" "Cinema" "Show" ...
##   .. .. ..$ : chr [1:2] "p.value" "df"
##   ..$ category  :List of 5
##   .. ..$ 1: num [1:54, 1:5] 39.4 56.3 40 36.3 38.7 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:54] "Computer=Computer_0" "Listening.music=Listening music_0" "Cinema=Cinema_0" "Exhibition=Exhibition_0" ...
##   .. .. .. ..$ : chr [1:5] "Cla/Mod" "Mod/Cla" "Global" "p.value" ...
##   .. ..$ 2: num [1:56, 1:5] 60.9 26.7 28.6 23.9 24.1 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:56] "Knitting=Knitting_1" "Sex=F" "Cooking=Cooking_1" "Sport=Sport_0" ...
##   .. .. .. ..$ : chr [1:5] "Cla/Mod" "Mod/Cla" "Global" "p.value" ...
##   .. ..$ 3: num [1:51, 1:5] 68.3 29.6 28.6 25.8 17.9 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:51] "Fishing=Fishing_1" "Mechanic=Mechanic_1" "Gardening=Gardening_1" "Sex=M" ...
##   .. .. .. ..$ : chr [1:5] "Cla/Mod" "Mod/Cla" "Global" "p.value" ...
##   .. ..$ 4: num [1:46, 1:5] 31 36.4 26.7 33.4 50.2 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:46] "Gardening=Gardening_0" "Cinema=Cinema_1" "Listening.music=Listening music_1" "Computer=Computer_1" ...
##   .. .. .. ..$ : chr [1:5] "Cla/Mod" "Mod/Cla" "Global" "p.value" ...
##   .. ..$ 5: num [1:58, 1:5] 44.4 54.2 54.2 43 41.6 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:58] "Travelling=Travelling_1" "Exhibition=Exhibition_1" "Show=Show_1" "Cinema=Cinema_1" ...
##   .. .. .. ..$ : chr [1:5] "Cla/Mod" "Mod/Cla" "Global" "p.value" ...
##   ..$ quanti.var: num [1, 1:2] 0.764 0
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr "nb.activitees"
##   .. .. ..$ : chr [1:2] "Eta2" "P-value"
##   ..$ quanti    :List of 5
##   .. ..$ 1: num [1, 1:6] -63.37 2.95 6.87 1.23 3.38 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr "nb.activitees"
##   .. .. .. ..$ : chr [1:6] "v.test" "Mean in category" "Overall mean" "sd in category" ...
##   .. ..$ 2: NULL
##   .. ..$ 3: NULL
##   .. ..$ 4: NULL
##   .. ..$ 5: num [1, 1:6] 66.17 11.59 6.87 1.72 3.38 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr "nb.activitees"
##   .. .. .. ..$ : chr [1:6] "v.test" "Mean in category" "Overall mean" "sd in category" ...
##   ..$ call      :List of 3
##   .. ..$ num.var: int 24
##   .. ..$ proba  : num 0.05
##   .. ..$ row.w  : num [1:8403] 1 1 1 1 1 1 1 1 1 1 ...
##   ..- attr(*, "class")= chr [1:2] "catdes" "list "
##  $ desc.axes :List of 3
##   ..$ quanti.var: num [1:4, 1:2] 0.776 0.506 0.476 0.128 0 ...
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:4] "Dim.1" "Dim.2" "Dim.3" "Dim.4"
##   .. .. ..$ : chr [1:2] "Eta2" "P-value"
##   ..$ quanti    :List of 5
##   .. ..$ 1: num [1:4, 1:6] 21.0736 1.9726 -18.5427 -59.571 0.0965 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:4] "Dim.4" "Dim.3" "Dim.2" "Dim.1"
##   .. .. .. ..$ : chr [1:6] "v.test" "Mean in category" "Overall mean" "sd in category" ...
##   .. ..$ 2: num [1:4, 1:6] 37.238 -4.5 -8.356 -48.933 0.255 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:4] "Dim.2" "Dim.4" "Dim.1" "Dim.3"
##   .. .. .. ..$ : chr [1:6] "v.test" "Mean in category" "Overall mean" "sd in category" ...
##   .. ..$ 3: num [1:4, 1:6] 48.528 35.131 -7.715 -15.363 0.335 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:4] "Dim.3" "Dim.2" "Dim.1" "Dim.4"
##   .. .. .. ..$ : chr [1:6] "v.test" "Mean in category" "Overall mean" "sd in category" ...
##   .. ..$ 4: num [1:4, 1:6] 10.3386 -2.5593 -20.7593 -47.4864 0.0991 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:4] "Dim.1" "Dim.3" "Dim.4" "Dim.2"
##   .. .. .. ..$ : chr [1:6] "v.test" "Mean in category" "Overall mean" "sd in category" ...
##   .. ..$ 5: num [1:3, 1:6] 68.5649 15.4312 2.7695 0.6434 0.0817 ...
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:3] "Dim.1" "Dim.4" "Dim.3"
##   .. .. .. ..$ : chr [1:6] "v.test" "Mean in category" "Overall mean" "sd in category" ...
##   ..$ call      :List of 3
##   .. ..$ num.var: int 5
##   .. ..$ proba  : num 0.05
##   .. ..$ row.w  : num [1:8403] 1 1 1 1 1 1 1 1 1 1 ...
##   ..- attr(*, "class")= chr [1:2] "catdes" "list "
##  $ call      :List of 8
##   ..$ t               :List of 6
##   .. ..$ res       :List of 7
##   .. .. ..$ eig       : num [1:21, 1:3] 0.1977 0.0806 0.072 0.0629 0.0585 ...
##   .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. ..$ : chr [1:21] "dim 1" "dim 2" "dim 3" "dim 4" ...
##   .. .. .. .. ..$ : chr [1:3] "eigenvalue" "percentage of variance" "cumulative percentage of variance"
##   .. .. ..$ call      :List of 14
##   .. .. .. ..$ X         :'data.frame':  8403 obs. of  23 variables:
##   .. .. .. .. ..$ Reading        : Factor w/ 2 levels "Reading_0","Reading_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Listening music: Factor w/ 2 levels "Listening music_0",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Cinema         : Factor w/ 2 levels "Cinema_0","Cinema_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Show           : Factor w/ 2 levels "Show_0","Show_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Exhibition     : Factor w/ 2 levels "Exhibition_0",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Computer       : Factor w/ 2 levels "Computer_0","Computer_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Sport          : Factor w/ 2 levels "Sport_0","Sport_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Walking        : Factor w/ 2 levels "Walking_0","Walking_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Travelling     : Factor w/ 2 levels "Travelling_0",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Playing music  : Factor w/ 2 levels "Playing music_0",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Collecting     : Factor w/ 2 levels "Collecting_0",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Volunteering   : Factor w/ 2 levels "Volunteering_0",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Mechanic       : Factor w/ 2 levels "Mechanic_0","Mechanic_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Gardening      : Factor w/ 2 levels "Gardening_0",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Knitting       : Factor w/ 2 levels "Knitting_0","Knitting_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Cooking        : Factor w/ 2 levels "Cooking_0","Cooking_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Fishing        : Factor w/ 2 levels "Fishing_0","Fishing_1": 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ TV             : Factor w/ 5 levels "TV_0","TV_1",..: 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Sex            : Factor w/ 2 levels "F","M": 1 2 1 1 2 2 1 1 1 1 ...
##   .. .. .. .. ..$ Age            : Factor w/ 8 levels "(25,35]","(35,45]",..: 6 1 5 3 7 5 7 5 3 4 ...
##   .. .. .. .. ..$ Marital status : Factor w/ 5 levels "Divorcee","Married",..: 3 4 5 2 5 2 5 5 1 2 ...
##   .. .. .. .. ..$ Profession     : Factor w/ 8 levels "Employee","Foreman",..: 3 6 1 4 6 8 6 8 1 6 ...
##   .. .. .. .. ..$ nb.activitees  : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. ..$ marge.col : Named num [1:39] 0.0182 0.0373 0.0162 0.0393 0.0333 ...
##   .. .. .. .. ..- attr(*, "names")= chr [1:39] "Reading_0" "Reading_1" "Listening music_0" "Listening music_1" ...
##   .. .. .. ..$ marge.row : Named num [1:8403] 0.000119 0.000119 0.000119 0.000119 0.000119 ...
##   .. .. .. .. ..- attr(*, "names")= chr [1:8403] "11000210" "11000410" "11000610" "11000710" ...
##   .. .. .. ..$ ncp       : num 4
##   .. .. .. ..$ row.w     : num [1:8403] 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. ..$ excl      : NULL
##   .. .. .. ..$ call      : language MCA(X = hobbies, ncp = 4, quanti.sup = 23, quali.sup = 19:22, graph = F)
##   .. .. .. ..$ Xtot      :'data.frame':  8403 obs. of  62 variables:
##   .. .. .. .. ..$ Reading_0        : int [1:8403] 0 0 0 0 0 1 1 0 0 0 ...
##   .. .. .. .. ..$ Reading_1        : int [1:8403] 1 1 1 1 1 0 0 1 1 1 ...
##   .. .. .. .. ..$ Listening music_0: int [1:8403] 0 1 0 1 0 1 0 0 0 0 ...
##   .. .. .. .. ..$ Listening music_1: int [1:8403] 1 0 1 0 1 0 1 1 1 1 ...
##   .. .. .. .. ..$ Cinema_0         : int [1:8403] 0 1 1 1 0 1 1 0 0 0 ...
##   .. .. .. .. ..$ Cinema_1         : int [1:8403] 1 0 0 0 1 0 0 1 1 1 ...
##   .. .. .. .. ..$ Show_0           : int [1:8403] 0 1 1 1 0 1 1 0 0 1 ...
##   .. .. .. .. ..$ Show_1           : int [1:8403] 1 0 0 0 1 0 0 1 1 0 ...
##   .. .. .. .. ..$ Exhibition_0     : int [1:8403] 0 0 0 0 1 1 1 0 1 0 ...
##   .. .. .. .. ..$ Exhibition_1     : int [1:8403] 1 1 1 1 0 0 0 1 0 1 ...
##   .. .. .. .. ..$ Computer_0       : int [1:8403] 1 1 1 1 1 1 0 0 0 1 ...
##   .. .. .. .. ..$ Computer_1       : int [1:8403] 0 0 0 0 0 0 1 1 1 0 ...
##   .. .. .. .. ..$ Sport_0          : int [1:8403] 0 0 1 0 1 1 0 1 0 1 ...
##   .. .. .. .. ..$ Sport_1          : int [1:8403] 1 1 0 1 0 0 1 0 1 0 ...
##   .. .. .. .. ..$ Walking_0        : int [1:8403] 0 0 1 1 0 1 1 1 0 1 ...
##   .. .. .. .. ..$ Walking_1        : int [1:8403] 1 1 0 0 1 0 0 0 1 0 ...
##   .. .. .. .. ..$ Travelling_0     : int [1:8403] 0 1 0 0 1 1 1 0 0 1 ...
##   .. .. .. .. ..$ Travelling_1     : int [1:8403] 1 0 1 1 0 0 0 1 1 0 ...
##   .. .. .. .. ..$ Playing music_0  : int [1:8403] 1 1 1 1 1 1 1 1 0 0 ...
##   .. .. .. .. ..$ Playing music_1  : int [1:8403] 0 0 0 0 0 0 0 0 1 1 ...
##   .. .. .. .. ..$ Collecting_0     : int [1:8403] 1 0 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Collecting_1     : int [1:8403] 0 1 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Volunteering_0   : int [1:8403] 0 0 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Volunteering_1   : int [1:8403] 1 1 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Mechanic_0       : int [1:8403] 0 0 1 1 1 0 0 1 1 0 ...
##   .. .. .. .. ..$ Mechanic_1       : int [1:8403] 1 1 0 0 0 1 1 0 0 1 ...
##   .. .. .. .. ..$ Gardening_0      : int [1:8403] 1 0 1 1 1 1 1 1 1 0 ...
##   .. .. .. .. ..$ Gardening_1      : int [1:8403] 0 1 0 0 0 0 0 0 0 1 ...
##   .. .. .. .. ..$ Knitting_0       : int [1:8403] 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Knitting_1       : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Cooking_0        : int [1:8403] 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Cooking_1        : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Fishing_0        : int [1:8403] 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. .. .. ..$ Fishing_1        : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ TV_0             : int [1:8403] 0 0 0 0 0 0 0 1 0 0 ...
##   .. .. .. .. ..$ TV_1             : int [1:8403] 0 0 0 1 0 0 0 0 1 1 ...
##   .. .. .. .. ..$ TV_2             : int [1:8403] 1 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ TV_3             : int [1:8403] 0 0 0 0 1 1 1 0 0 0 ...
##   .. .. .. .. ..$ TV_4             : int [1:8403] 0 1 1 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ F                : int [1:8403] 1 0 1 0 0 0 0 0 1 1 ...
##   .. .. .. .. ..$ M                : int [1:8403] 0 1 0 1 1 1 1 1 0 0 ...
##   .. .. .. .. ..$ (25,35]          : int [1:8403] 0 0 1 0 0 0 0 0 0 1 ...
##   .. .. .. .. ..$ (35,45]          : int [1:8403] 0 0 0 0 0 0 1 0 1 0 ...
##   .. .. .. .. ..$ (45,55]          : int [1:8403] 0 1 0 0 0 1 0 0 0 0 ...
##   .. .. .. .. ..$ (55,65]          : int [1:8403] 1 0 0 0 1 0 0 0 0 0 ...
##   .. .. .. .. ..$ (65,75]          : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ (75,85]          : int [1:8403] 0 0 0 1 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ (85,100]         : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ [15,25]          : int [1:8403] 0 0 0 0 0 0 0 1 0 0 ...
##   .. .. .. .. ..$ Divorcee         : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Married          : int [1:8403] 1 1 0 1 1 1 1 0 0 0 ...
##   .. .. .. .. ..$ Remarried        : int [1:8403] 0 0 1 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Single           : int [1:8403] 0 0 0 0 0 0 0 1 1 1 ...
##   .. .. .. .. ..$ Widower          : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Employee         : int [1:8403] 0 0 0 0 1 0 1 0 0 1 ...
##   .. .. .. .. ..$ Foreman          : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Management       : int [1:8403] 1 0 1 0 0 0 0 0 1 0 ...
##   .. .. .. .. ..$ Manual labourer  : int [1:8403] 0 0 0 0 0 1 0 0 0 0 ...
##   .. .. .. .. ..$ Other            : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Profession.NA    : int [1:8403] 0 1 0 1 0 0 0 1 0 0 ...
##   .. .. .. .. ..$ Technician       : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. .. ..$ Unskilled worker : int [1:8403] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. .. ..$ N         : num 151254
##   .. .. .. ..$ col.sup   : int [1:23] 40 41 42 43 44 45 46 47 48 49 ...
##   .. .. .. ..$ quali     : int [1:18] 1 2 3 4 5 6 7 8 9 10 ...
##   .. .. .. ..$ quali.sup : int [1:4] 19 20 21 22
##   .. .. .. ..$ quanti.sup: num 23
##   .. .. .. ..$ row.w.init: num [1:8403] 1 1 1 1 1 1 1 1 1 1 ...
##   .. .. ..$ ind       :List of 3
##   .. .. .. ..$ coord  :'data.frame': 8403 obs. of  4 variables:
##   .. .. .. .. ..$ Dim 1: num [1:8403] -0.791 -0.791 -0.791 -0.791 -0.791 ...
##   .. .. .. .. ..$ Dim 2: num [1:8403] -0.247 -0.247 -0.247 -0.247 -0.247 ...
##   .. .. .. .. ..$ Dim 3: num [1:8403] 0.108 0.108 0.108 0.108 0.108 ...
##   .. .. .. .. ..$ Dim 4: num [1:8403] 0.476 0.476 0.476 0.476 0.476 ...
##   .. .. .. ..$ contrib: num [1:8403, 1:4] 2.68e-02 1.17e-03 1.45e-03 6.99e-04 2.78e-05 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:8403] "11000210" "11000410" "11000610" "11000710" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ cos2   : num [1:8403, 1:4] 0.335743 0.011164 0.031778 0.010507 0.000558 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:8403] "11000210" "11000410" "11000610" "11000710" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. ..$ var       :List of 5
##   .. .. .. ..$ coord  : num [1:39, 1:4] -0.699 0.341 -0.817 0.337 -0.509 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:39] "Reading_0" "Reading_1" "Listening music_0" "Listening music_1" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ contrib: num [1:39, 1:4] 4.5 2.2 5.48 2.26 4.37 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:39] "Reading_0" "Reading_1" "Listening music_0" "Listening music_1" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ cos2   : num [1:39, 1:4] 0.239 0.239 0.275 0.275 0.389 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:39] "Reading_0" "Reading_1" "Listening music_0" "Listening music_1" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ v.test : num [1:39, 1:4] -44.8 44.8 -48.1 48.1 -57.2 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:39] "Reading_0" "Reading_1" "Listening music_0" "Listening music_1" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ eta2   : num [1:18, 1:4] 0.239 0.275 0.389 0.383 0.399 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:18] "Reading" "Listening music" "Cinema" "Show" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. ..$ svd       :List of 3
##   .. .. .. ..$ vs: num [1:39] 0.445 0.284 0.268 0.251 0.242 ...
##   .. .. .. ..$ U : num [1:8403, 1:4] 1.4999 0.3142 -0.3492 -0.2424 -0.0484 ...
##   .. .. .. ..$ V : num [1:39, 1:4] -1.572 0.768 -1.837 0.759 -1.145 ...
##   .. .. ..$ quali.sup :List of 4
##   .. .. .. ..$ coord : num [1:23, 1:4] 0.0176 -0.0214 0.2674 0.201 0.0219 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:23] "F" "M" "(25,35]" "(35,45]" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ cos2  : num [1:23, 1:4] 0.000377 0.000377 0.013109 0.009838 0.000135 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:23] "F" "M" "(25,35]" "(35,45]" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ v.test: num [1:23, 1:4] 1.78 -1.78 10.49 9.09 1.06 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:23] "F" "M" "(25,35]" "(35,45]" ...
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. .. ..$ eta2  : num [1:4, 1:4] 0.000377 0.097479 0.045662 0.128368 0.002153 ...
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr [1:4] "Sex" "Age" "Marital status" "Profession"
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. ..$ quanti.sup:List of 1
##   .. .. .. ..$ coord: num [1, 1:4] 0.9753 0.198 0.0126 -0.0581
##   .. .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. .. ..$ : chr "nb.activitees"
##   .. .. .. .. .. ..$ : chr [1:4] "Dim 1" "Dim 2" "Dim 3" "Dim 4"
##   .. .. ..- attr(*, "class")= chr [1:2] "MCA" "list"
##   .. ..$ tree      :List of 7
##   .. .. ..$ merge      : int [1:8402, 1:2] -1 -3 -4 -5 -6 -7 -8 -9 -10 -11 ...
##   .. .. ..$ height     : num [1:8402] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. ..$ order      : int [1:8403] 8219 7838 7939 7598 8036 7992 7993 8071 8060 8005 ...
##   .. .. ..$ labels     : chr [1:8403] "11023410" "22031210" "22032610" "23010810" ...
##   .. .. ..$ method     : chr "ward"
##   .. .. ..$ call       : language flashClust::hclust(d = dissi, method = method, members = weight)
##   .. .. ..$ dist.method: chr "euclidean"
##   .. .. ..- attr(*, "class")= chr "hclust"
##   .. ..$ nb.clust  : num 3
##   .. ..$ within    : num [1:8402] 0.413 0.298 0.264 0.234 0.215 ...
##   .. ..$ inert.gain: num [1:8402] 0.1148 0.0343 0.0302 0.0193 0.0174 ...
##   .. ..$ quot      : num [1:8] 0.885 0.886 0.918 0.919 0.927 ...
##   ..$ min             : num 3
##   ..$ max             : num 10
##   ..$ X               :'data.frame': 8403 obs. of  5 variables:
##   .. ..$ Dim 1: num [1:8403] -0.791 -0.791 -0.791 -0.791 -0.791 ...
##   .. ..$ Dim 2: num [1:8403] -0.247 -0.247 -0.247 -0.247 -0.247 ...
##   .. ..$ Dim 3: num [1:8403] 0.108 0.108 0.108 0.108 0.108 ...
##   .. ..$ Dim 4: num [1:8403] 0.476 0.476 0.476 0.476 0.476 ...
##   .. ..$ clust: Factor w/ 5 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ bw.before.consol: num 0.199
##   ..$ bw.after.consol : num 0.236
##   ..$ vec             : logi FALSE
##   ..$ call            : language HCPC(res = acm, nb.clust = 5, graph = F)
##  $ desc.ind  :List of 2
##   ..$ para:List of 5
##   .. ..$ 1: Named num [1:5] 0.0645 0.0645 0.0701 0.0961 0.0972
##   .. .. ..- attr(*, "names")= chr [1:5] "41006010" "91003910" "82113010" "31002210" ...
##   .. ..$ 2: Named num [1:5] 0.0936 0.101 0.1154 0.1208 0.1242
##   .. .. ..- attr(*, "names")= chr [1:5] "42002410" "21071410" "52008610" "22012510" ...
##   .. ..$ 3: Named num [1:5] 0.0512 0.0901 0.0981 0.1019 0.1112
##   .. .. ..- attr(*, "names")= chr [1:5] "82040110" "93019310" "73031510" "21070410" ...
##   .. ..$ 4: Named num [1:5] 0.0518 0.0737 0.0797 0.0813 0.0845
##   .. .. ..- attr(*, "names")= chr [1:5] "43035410" "53020410" "26012910" "52011810" ...
##   .. ..$ 5: Named num [1:5] 0.0588 0.1004 0.1088 0.1151 0.1162
##   .. .. ..- attr(*, "names")= chr [1:5] "53003910" "31006410" "24015110" "93102910" ...
##   .. ..- attr(*, "dim")= int 5
##   .. ..- attr(*, "dimnames")=List of 1
##   .. .. ..$ Cluster: chr [1:5] "1" "2" "3" "4" ...
##   .. ..- attr(*, "call")= language by.data.frame(data = tabInd, INDICES = cluster, FUN = select, default.size = nb.par,      method = metric, coord.| __truncated__
##   .. ..- attr(*, "class")= chr "by"
##   ..$ dist:List of 5
##   .. ..$ 1: Named num [1:5] 1.15 1.15 1.14 1.13 1.12
##   .. .. ..- attr(*, "names")= chr [1:5] "11095510" "22033810" "54026710" "93109510" ...
##   .. ..$ 2: Named num [1:5] 1.2 1.13 1.08 1.03 1.02
##   .. .. ..- attr(*, "names")= chr [1:5] "43026910" "42019410" "74018410" "93049110" ...
##   .. ..$ 3: Named num [1:5] 1.17 1.13 1.13 1.11 1.11
##   .. .. ..- attr(*, "names")= chr [1:5] "53059510" "22000410" "24042510" "93105810" ...
##   .. ..$ 4: Named num [1:5] 0.925 0.906 0.9 0.872 0.871
##   .. .. ..- attr(*, "names")= chr [1:5] "93107010" "31040115" "24049910" "24063610" ...
##   .. ..$ 5: Named num [1:5] 1.42 1.4 1.4 1.34 1.33
##   .. .. ..- attr(*, "names")= chr [1:5] "82007410" "82017110" "91048110" "93122510" ...
##   .. ..- attr(*, "dim")= int 5
##   .. ..- attr(*, "dimnames")=List of 1
##   .. .. ..$ Cluster: chr [1:5] "1" "2" "3" "4" ...
##   .. ..- attr(*, "call")= language by.data.frame(data = tabInd, INDICES = cluster, FUN = distinctivness,      default.size = nb.par, method = metric| __truncated__ ...
##   .. ..- attr(*, "class")= chr "by"
##  - attr(*, "class")= chr "HCPC"
\end{verbatim}

\hypertarget{determination-du-nombre-de-classes}{%
\subsection{Détermination du nombre de classes}\label{determination-du-nombre-de-classes}}

Pour déterminer le nombre optimal de classes, on regarde la perte d'inertie inter-classes (pour ça, il faut lancer une première fois la commande avec un nombre arbitraire de classes). En effet, on part d'une situation où il n'y a que de l'inertie inter-classes (chaque classe comprenant un seul individu, il n'y a pas d'inertie intra-classe). Au fur et à mesure des regroupements, on va donc perdre en inertie inter-classes, jusqu'à la dernière étape où il y a une classe avec tous les individus et donc plus d'inertie inter. Le but du jeu consiste à ``stopper'' l'aggrégation avant de perdre une forte quantité d'inertie inter-classe. On s'intéresse au dernières étapes pour ne pas alourdir le graphique (et on prendra un nombre de classe inférieur à 20 en général, sinon, ce n'est pas très opérationnel\ldots{}). Ce diagramme ressemble très fortement à l'éboulis des valeurs propres, et on cherche à peu près la même chose (un saut).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{barplot}\NormalTok{(hc}\OperatorTok{$}\NormalTok{call}\OperatorTok{$}\NormalTok{t}\OperatorTok{$}\NormalTok{inert.gain[}\DecValTok{1}\OperatorTok{:}\DecValTok{20}\NormalTok{],}\DataTypeTok{horiz =}\NormalTok{ T,}\DataTypeTok{main=}\StringTok{"Gain d'inertie intra sur les 20 dernières agrégations "}\NormalTok{,}
          \DataTypeTok{col=}\StringTok{"lightblue"}\NormalTok{,}\DataTypeTok{border =} \StringTok{"grey"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/clust_4-1.pdf}

Autre représentation : le dendogramme représente les étapes d'agrégation. La auteur des branches représente la perte d'inertie inter-classe (ou le gain d'inertie intra)

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(hc, }\DataTypeTok{choice =}\StringTok{"tree"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/clust_5-1.pdf}

\hypertarget{description-des-classes}{%
\subsection{Description des classes}\label{description-des-classes}}

Une fois que l'on a déterminé le nombre de classes, il reste à les décrire. Premier outil : le tableau croisé pour voir la taille de chacun.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{table}\NormalTok{ (hc}\OperatorTok{$}\NormalTok{data.clust}\OperatorTok{$}\NormalTok{clust)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##    1    2    3    4    5 
## 2209 1431 1278 1713 1772
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hc}\OperatorTok{$}\NormalTok{desc.var}\OperatorTok{$}\NormalTok{category}\OperatorTok{$}\StringTok{`}\DataTypeTok{1}\StringTok{`}
\NormalTok{hc}\OperatorTok{$}\NormalTok{desc.ind}\OperatorTok{$}\NormalTok{para}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  cla/mod indique quelle part (pourcentage) de tous les individus présentant cette modalité se
  retrouve dans cette classe
\item
  mod/cla indique quelle part (pourcentage) de tous les individus de la classe présentent cette
  modalité.
\item
  Les parangons sont les individus les plus représentatifs de la classe
\end{itemize}

Visualisation du dendogrades classes sur les axes factoriels

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(hc, }\DataTypeTok{choice =}\StringTok{"3D.map"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/plot_hc-1.pdf}

\hypertarget{quelques-conseils-pratiques}{%
\subsection{Quelques conseils pratiques}\label{quelques-conseils-pratiques}}

Le but d'un classification est d'obtenir des groupes d'individus qui ``parlent'' (c'est un outils de communication puissant) ; l'application des méthodes à la lettre peut ne pas aboutir à un tel résultat. On peut alors jouer sur différents paramètres :

\begin{itemize}
\tightlist
\item
  Les variables mobilisées
\item
  Le nombre de classes
\item
  La distance
\item
  La méthode d'agrégation
\item
  Utiliser une méthode non hiérarchique (exemple : \texttt{kmeans}) \(\rightarrow\) pour ``consolider'' la CAH avec cette méthode (permet de minimiser la variance intra)
\end{itemize}

Remarque importante : l'algorithme est très coûteux et est très lent quand le nombre d'individus est important. On peut alors réduire le nombre d'individus initial en procédant au préalable à une classification avec kmeans. La fonction \texttt{HCPC} permet de le faire avec le paramètre kk=.

Il faut ensuite donner un nom aux classes (pas uniquement les décrire) : attention aux termes utilisés !

\hypertarget{exercice-3}{%
\section{Exercice}\label{exercice-3}}

Reprendre la base de données sur les iris et réaliser une classification des 150 fleurs

\begin{itemize}
\tightlist
\item
  Avec kmeans
\item
  Avec une CAH
\item
  Que peut-on dire des résultats et leur lien avec la variable Species ?
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hc.iris <-}\StringTok{ }\KeywordTok{HCPC}\NormalTok{ (acp.iris, }\DataTypeTok{nb.clust =} \DecValTok{3}\NormalTok{)}
\NormalTok{kmeans.iris <-}\StringTok{ }\KeywordTok{kmeans}\NormalTok{ (acp.iris}\OperatorTok{$}\NormalTok{ind}\OperatorTok{$}\NormalTok{coord, }\DataTypeTok{centers =} \DecValTok{3}\NormalTok{)}
\NormalTok{res.iris <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{ (acp.iris}\OperatorTok{$}\NormalTok{ind}\OperatorTok{$}\NormalTok{coord, }\DataTypeTok{classe =} \KeywordTok{as.factor}\NormalTok{ (kmeans.iris}\OperatorTok{$}\NormalTok{cluster),}
                       \DataTypeTok{Species =}\NormalTok{ iris}\OperatorTok{$}\NormalTok{Species)}

\KeywordTok{ggplot}\NormalTok{ (res.iris, }\KeywordTok{aes}\NormalTok{ (}\DataTypeTok{x =}\NormalTok{ Dim}\FloatTok{.1}\NormalTok{, }\DataTypeTok{y =}\NormalTok{ Dim}\FloatTok{.2}\NormalTok{, }\DataTypeTok{color =}\NormalTok{ classe)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

On compare à la vraie classe. Conclusion : la nature est mal faite\ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# La vraie classe :}

\KeywordTok{ggplot}\NormalTok{ (res.iris, }\KeywordTok{aes}\NormalTok{ (}\DataTypeTok{x =}\NormalTok{ Dim}\FloatTok{.1}\NormalTok{, }\DataTypeTok{y =}\NormalTok{ Dim}\FloatTok{.2}\NormalTok{, }\DataTypeTok{color =}\NormalTok{ Species)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{ ()}
\end{Highlighting}
\end{Shaded}

\includegraphics{exploration_avancee_files/figure-latex/clust_9-1.pdf}


\end{document}
